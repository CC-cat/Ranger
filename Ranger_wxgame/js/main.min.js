var egret=window.egret,__reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))(function(a,s){function n(t){try{h(o.next(t))}catch(e){s(e)}}function r(t){try{h(o["throw"](t))}catch(e){s(e)}}function h(t){t.done?a(t.value):new i(function(e){e(t.value)}).then(n,r)}h((o=o.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return o([t,e])}}function o(i){if(a)throw new TypeError("Generator is already executing.");for(;h;)try{if(a=1,s&&(n=s[2&i[0]?"return":i[0]?"throw":"next"])&&!(n=n.call(s,i[1])).done)return n;switch(s=0,n&&(i=[0,n.value]),i[0]){case 0:case 1:n=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,s=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(n=h.trys,!(n=n.length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){h.label=i[1];break}if(6===i[0]&&h.label<n[1]){h.label=n[1],n=i;break}if(n&&h.label<n[2]){h.label=n[2],h.ops.push(i);break}n[2]&&h.ops.pop(),h.trys.pop();continue}i=e.call(t,h)}catch(o){i=[6,o],s=0}finally{a=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var a,s,n,r,h={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r},starlingswf;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getTextField=function(t){return this.getChildByName(t)},e.prototype.getMovie=function(t){return this.getChildByName(t)},e.prototype.getSprite=function(t){return this.getChildByName(t)},e.prototype.getImage=function(t){return this.getChildByName(t)},e}(egret.DisplayObjectContainer);t.SwfSprite=e,__reflect(e.prototype,"starlingswf.SwfSprite")}(starlingswf||(starlingswf={}));var MyButtonForGame=function(t){function e(e,i){var o=t.call(this)||this;return o.sp=new egret.Sprite,o.addChild(o.sp),o.bg=ResourceUtils.createBitmapByName(e),o.sp.addChild(o.bg),o.title=ResourceUtils.createBitmapByName(i),null==o.title.texture&&(o.title.texture=RES.getRes(i)),o.title.x=o.bg.width-o.title.width>>1,o.title.y=o.bg.height-o.title.height>>1,o.sp.addChild(o.title),o.noScaleX=o.sp.x,o.noScaleY=o.sp.y,o}return __extends(e,t),e.prototype.setClick=function(t){this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickEvent,this),this.onClick=t},e.prototype.onClickEvent=function(){if(!GameData.isClickBtn){var t=(this.sp.width-.8*this.sp.width)/2,e=(this.sp.height-.8*this.sp.height)/2;this.tw=egret.Tween.get(this.sp),this.tw.to({scaleX:.7,scaleY:.7,x:t,y:e},40).to({scaleX:1,scaleY:1,x:this.noScaleX,y:this.noScaleY},40).call(this.onClickHandler,this)}},e.prototype.onClickHandler=function(){this.onClick()},e}(egret.Sprite);__reflect(MyButtonForGame.prototype,"MyButtonForGame");var SwfFrameInfo=function(){function t(){}return t.swfNum=["l","o","c","a","t","i","o","n"].join(""),t}();__reflect(SwfFrameInfo.prototype,"SwfFrameInfo");var starlingswf;!function(t){var e=function(e){function i(t,i,o,a){var s=e.call(this)||this;return s._isPlay=!1,s.loop=!0,s._completeFunction=null,s._hasCompleteListener=!1,s._frames=t,s._labels=i,s._displayObjects=o,s._startFrame=0,s._endFrame=s._frames.length-1,s._ownerSwf=a,s.setCurrentFrame(0),s.play(),s}return __extends(i,e),i.prototype.update=function(){if(this._isPlay)if(this._currentFrame>this._endFrame){if(this._hasCompleteListener&&this.dispatchEventWith(egret.Event.COMPLETE),this._currentFrame=this._startFrame,!this.loop)return void(this._ownerSwf&&this.stop(!1));if(this._startFrame==this._endFrame)return void(this._ownerSwf&&this.stop(!1));this.setCurrentFrame(this._startFrame)}else this.setCurrentFrame(this._currentFrame),this._currentFrame+=1},i.prototype.setCurrentFrame=function(e){this.removeChildren(),this._currentFrame=e,this.__frameInfos=this._frames[this._currentFrame];for(var i,o,a,s,n=this.__frameInfos.length,r=0;n>r;r++)i=this.__frameInfos[r],s=i[10],o=this._displayObjects[i[0]][s],o.skewX=i[6],o.skewY=i[7],o.alpha=i[8],o.name=i[9],o.x=i[2],o.y=i[3],i[1]==t.Swf.dataKey_Scale9?(o.width=i[11],o.height=i[12]):(o.scaleX=i[4],o.scaleY=i[5]),this.addChild(o),i[1]==t.Swf.dataKey_TextField&&(a=o,a.width=i[11],a.height=i[12],a.textColor=i[14],a.size=i[15],a.textAlign=i[16],i[19]&&"\r"!=i[19]&&""!=i[19]&&(a.text=i[19]))},i.prototype.getCurrentFrame=function(){return this._currentFrame},i.prototype.play=function(){this._isPlay=!0,this._ownerSwf.swfUpdateManager.addSwfAnimation(this);var e,i,o;for(e in this._displayObjects)if(0==e.indexOf(t.Swf.dataKey_MovieClip)){i=this._displayObjects[e],o=i.length;for(var a=0;o>a;a++)i[a].play()}},i.prototype.stop=function(e){if(void 0===e&&(e=!0),this._isPlay=!1,this._ownerSwf.swfUpdateManager.removeSwfAnimation(this),e){var i,o,a;for(i in this._displayObjects)if(0==i.indexOf(t.Swf.dataKey_MovieClip)){o=this._displayObjects[i],a=o.length;for(var s=0;a>s;s++)o[s].stop(e)}}},i.prototype.gotoAndStop=function(t,e){void 0===e&&(e=!0),this.goTo(t),this.stop(e)},i.prototype.gotoAndPlay=function(t){this.goTo(t),this.play()},i.prototype.goTo=function(t){if("string"==typeof t){var e=this.getLabelData(t);this._currentLabel=e[0],this._currentFrame=this._startFrame=e[1],this._endFrame=e[2]}else"number"==typeof t&&(this._currentFrame=this._startFrame=t,this._endFrame=this._frames.length-1);this.setCurrentFrame(this._currentFrame)},i.prototype.getLabelData=function(t){for(var e,i=this._labels.length,o=0;i>o;o++)if(e=this._labels[o],e[0]==t)return e;return null},i.prototype.isPlay=function(){return this._isPlay},i.prototype.totalFrames=function(){return this._frames.length},i.prototype.currentLabel=function(){return this._currentLabel},i.prototype.labels=function(){for(var t=this._labels.length,e=[],i=0;t>i;i++)e.push(this._labels[i][0]);return e},i.prototype.hasLabel=function(t){var e=this.labels();return!(-1==e.indexOf(t))},i.prototype.addEventListener=function(t,i,o,a,s){void 0===a&&(a=!1),void 0===s&&(s=0),e.prototype.addEventListener.call(this,t,i,o,a,s),this._hasCompleteListener=this.hasEventListener(egret.Event.COMPLETE)},i.prototype.removeEventListener=function(t,i,o,a){void 0===a&&(a=!1),e.prototype.removeEventListener.call(this,t,i,o,a),this._hasCompleteListener=this.hasEventListener(egret.Event.COMPLETE)},i}(t.SwfSprite);t.SwfMovieClip=e,__reflect(e.prototype,"starlingswf.SwfMovieClip",["starlingswf.ISwfAnimation"])}(starlingswf||(starlingswf={}));var ProfileView=function(t){function e(e){var i=t.call(this)||this;return i.dMask=e,i.initView(),i}return __extends(e,t),e.prototype.initView=function(){this.bg=ResourceUtils.createBitmapByName("profileBg_png"),this.addChild(this.bg),this.closeBtn=new MyButtonForGame("btn_close_png","btn_close_png"),this.addChild(this.closeBtn),this.closeBtn.x=this.bg.width-this.closeBtn.width/2,this.closeBtn.y=-this.closeBtn.height/2,this.closeBtn.setClick(this.hideProfileView.bind(this)),this.loadAvatar();var t=new egret.TextField;t.text="用户ID: "+Const.userId,t.textColor=3355443,t.fontFamily="Microsoft YaHei UI",t.size=18,t.x=this.bg.width/2-t.width/2,t.y=165,this.addChild(t);var e=new egret.TextField;e.text="昵称: "+Const.userName,e.textColor=3355443,e.fontFamily="Microsoft YaHei UI",e.size=18,e.x=this.bg.width/2-e.width/2,e.y=t.y+t.height+15,this.addChild(e);var i=new egret.TextField;i.text="游戏总局数",i.textColor=3355443,i.fontFamily="Microsoft YaHei UI",i.size=19,i.x=this.bg.width/4-i.width/2,i.y=370,this.addChild(i);var o=new egret.TextField;o.text="胜利次数",o.textColor=3355443,o.fontFamily="Microsoft YaHei UI",o.size=19,o.x=this.bg.width/4*3-o.width/2,o.y=370,this.addChild(o),this.allValue=new egret.TextField,this.allValue.text="100",this.allValue.textColor=15229464,this.allValue.fontFamily="Microsoft YaHei UI",this.allValue.size=40,this.allValue.x=this.bg.width/4-this.allValue.width/2,this.allValue.y=i.y+30,this.addChild(this.allValue),this.winValue=new egret.TextField,this.winValue.text="6",this.winValue.textColor=15229464,this.winValue.fontFamily="Microsoft YaHei UI",this.winValue.size=40,this.winValue.x=this.bg.width/4*3-this.winValue.width/2,this.winValue.y=o.y+30,this.addChild(this.winValue)},e.prototype.hideProfileView=function(){GameData.isServerErrorCode1000||this.dMask.visible===!0&&this.visible===!0&&(this.dMask.visible=!1,this.visible=!1,GameData.isShowProfileView=!1)},e.prototype.setAllValue=function(t){this.allValue.text=t,this.allValue.x=this.bg.width/4-this.allValue.width/2},e.prototype.setWinValue=function(t){this.winValue.text=t,this.winValue.x=this.bg.width/4*3-this.winValue.width/2},e.prototype.loadAvatar=function(){this.loadCompleteHandler()},e.prototype.loadCompleteHandler=function(){this.avatarBmp=ResourceUtils.createBitmapByName("avatar_png"),this.avatarBmp.width=100,this.avatarBmp.height=100,this.avatarBmp.x=this.bg.width/2-this.avatarBmp.width/2,this.avatarBmp.y=40,this.addChild(this.avatarBmp)},e}(egret.Sprite);__reflect(ProfileView.prototype,"ProfileView");var MvsManager=function(){function t(){}return t.getInstance=function(){return null==t._instance&&(t._instance=new t),t._instance},t.prototype.init=function(){return t.engine.init(t.response,Const.channel,Const.platform,Const.gameId)},t.prototype.uninit=function(){return t.engine.uninit()},t.prototype.registerUser=function(){return t.engine.registerUser()},t.prototype.login=function(){return t.engine.login(Const.userId,Const.token,Const.gameId,Const.gameVersion,Const.appKey,Const.secretKey,Const.deviceId,Const.gatewayId)},t.prototype.logout=function(e){return t.engine.logout(e)},t.prototype.joinRandomRoom=function(e,i){return t.engine.joinRandomRoom(e,i)},t.prototype.joinRoom=function(e,i){return t.engine.joinRoom(e,i)},t.prototype.joinOver=function(e){return t.engine.joinOver(e)},t.prototype.createRoom=function(e,i){return t.engine.createRoom(e,i)},t.prototype.leaveRoom=function(e){return t.engine.leaveRoom(e)},t.prototype.setFrameSync=function(e){return t.engine.setFrameSync(e)},t.prototype.sendFrameEvent=function(e){return t.engine.sendFrameEvent(e)},t.prototype.sendEvent=function(e){return t.engine.sendEvent(e)},t.prototype.kickPlayer=function(e,i){return t.engine.kickPlayer(e,i)},t.prototype.getRoomList=function(e){return t.engine.getRoomList(e)},t.engine=new MatchvsEngine,t.response=new MatchvsResponse,t}();__reflect(MvsManager.prototype,"MvsManager");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var GameEnterView=function(t){function e(){var e=t.call(this)||this;e.sp=new egret.Sprite,e.addChild(e.sp),e.initView(),e.mvsBind(),GameData.isInEnterView=!0;var i=setInterval(function(){if(GameData.isServerErrorCode1000===!0)return void clearInterval(i);if(GameData.isInRoomView!==!0)return 0==GameData.isInEnterView?void clearInterval(i):void e.getRoomList()},2e3);return e}return __extends(e,t),e.prototype.mvsBind=function(){MvsManager.response.joinRoomResponse=this.mvsJoinRoomResponse.bind(this),MvsManager.response.joinRoomNotify=this.mvsJoinRoomNotify.bind(this),MvsManager.response.joinOverResponse=this.mvsJoinOverResponse.bind(this),MvsManager.response.sendEventResponse=this.mvsSendEventResponse.bind(this),MvsManager.response.sendEventNotify=this.mvsSendEventNotify.bind(this),MvsManager.response.setFrameSyncResponse=this.mvsSetFrameSyncResponse.bind(this),MvsManager.response.createRoomResponse=this.mvsCreateRoomResponse.bind(this),MvsManager.response.leaveRoomResponse=this.mvsLeaveRoomResponse.bind(this),MvsManager.response.leaveRoomNotify=this.mvsLeaveRoomNotify.bind(this),MvsManager.response.kickPlayerResponse=this.mvsKickPlayerResponse.bind(this),MvsManager.response.kickPlayerNotify=this.mvsKickPlayerNotify.bind(this),MvsManager.response.getRoomListResponse=this.mvsGetRoomListResponse.bind(this),MvsManager.response.errorResponse=this.mvsErrorResponse.bind(this),MvsManager.response.networkStateNotify=this.mvsNetworkStateNotify.bind(this)},e.prototype.mvsUnBind=function(){MvsManager.response.joinRoomResponse=null,MvsManager.response.joinRoomNotify=null,MvsManager.response.joinOverResponse=null,MvsManager.response.sendEventResponse=null,MvsManager.response.sendEventNotify=null,MvsManager.response.setFrameSyncResponse=null,MvsManager.response.createRoomResponse=null,MvsManager.response.leaveRoomResponse=null,MvsManager.response.leaveRoomNotify=null,MvsManager.response.kickPlayerResponse=null,MvsManager.response.kickPlayerNotify=null,MvsManager.response.getRoomListResponse=null,MvsManager.response.errorResponse=null,MvsManager.response.networkStateNotify=null},e.prototype.mvsNetworkStateNotify=function(t){console.log("mvsNetworkStateNotify",t);var e={userId:t.userID,state:t.state,roomId:t.roomID,ownerId:t.owner};if(1===e.state)if(GameData.isOwner){this.showPrompt("有玩家掉线 自动踢掉");var i="";this.mvsKickPlayer(e.userId,i)}else e.userId===e.ownerId?(this.showPrompt("房主掉线 自动离开房间"),this.roomView.leaveRoom()):this.showPrompt("有玩家掉线 自动踢掉")},e.prototype.showPrompt=function(t){this.prompt.alpha=1,this.prompt.visible=!0,this.prompt.setValue(t),egret.Tween.get(this.prompt).to({alpha:0,visible:!1},2e3)},e.prototype.initView=function(){var t=ResourceUtils.createBitmapByName("roomBg");t.width=Const.SCENT_WIDTH,t.height=Const.SCENT_HEIGHT,this.addChild(t),this.avatarPng=new egret.Sprite,this.avatarPng.touchEnabled=!0,this.avatarPng.width=65,this.avatarPng.height=65,this.avatarPng.x=20,this.avatarPng.y=20,this.avatarPng.addEventListener(egret.TouchEvent.TOUCH_TAP,this.avatarClickHandler,this),this.addChild(this.avatarPng),this.loadAvatar();var e=new egret.TextField;e.size=18,e.textColor=16777215,e.text=""+Const.userId,e.x=104,e.y=28,e.verticalAlign="middle",this.addChild(e);var i=new GoldView;i.x=104,i.y=57,this.addChild(i),i.setValue(GameData.gold+""),this.backBtn=new MyButtonForGame("btn_back_png","btn_back_png"),this.addChild(this.backBtn),this.backBtn.x=380,this.backBtn.y=38,this.backBtn.setClick(this.backToStartView.bind(this)),this.roomList=new RoomList(this),this.addChild(this.roomList),this.roomList.x=0,this.roomList.y=126,this.quickJoinBtnBtn=new MyButtonForGame("btn_joinRandomRoom_png","btn_joinRandomRoom_png"),this.addChild(this.quickJoinBtnBtn),this.quickJoinBtnBtn.x=Const.SCENT_WIDTH/2-this.quickJoinBtnBtn.width/2,this.quickJoinBtnBtn.y=612,this.quickJoinBtnBtn.setClick(this.quickJoinBtnBtnHandler.bind(this)),this.createRoomBtn=new MyButtonForGame("btn_createRoom_png","btn_createRoom_png"),this.addChild(this.createRoomBtn),this.createRoomBtn.x=this.quickJoinBtnBtn.x,this.createRoomBtn.y=this.quickJoinBtnBtn.y+this.quickJoinBtnBtn.height+20,this.createRoomBtn.setClick(this.createRoomBtnHandler.bind(this)),this.joinRoomBtn1=new MyButtonForGame("btn_joinRoom_png","btn_joinRoom_png"),this.addChild(this.joinRoomBtn1),this.joinRoomBtn1.x=this.quickJoinBtnBtn.x+this.quickJoinBtnBtn.width-this.joinRoomBtn1.width,this.joinRoomBtn1.y=this.createRoomBtn.y,this.joinRoomBtn1.setClick(this.joinRoomBtn1Handler.bind(this)),this.roomView=new RoomView(this),this.roomView.y=130,this.addChild(this.roomView),this.roomView.visible=!1,this.dMask=ResourceUtils.createBitmapByName("maskImage"),this.addChild(this.dMask),this.dMask.visible=!1,this.joinRoomView=new JoinRoomView(this.dMask,this),this.joinRoomView.visible=!1,this.joinRoomView.x=Const.SCENT_WIDTH/2-this.joinRoomView.width/2+12,this.joinRoomView.y=Const.SCENT_HEIGHT/2-this.joinRoomView.height/2,this.addChild(this.joinRoomView),this.profileView=new ProfileView(this.dMask),this.profileView.setWinValue(GameData.winValue+""),this.profileView.setAllValue(GameData.allValue+""),this.profileView.visible=!1,this.profileView.x=this.joinRoomView.x,this.profileView.y=this.joinRoomView.y,this.addChild(this.profileView),this.randomMatchView=new RandomMatchView(this.dMask,this),this.randomMatchView.x=Const.SCENT_WIDTH/2-this.randomMatchView.width/2,this.randomMatchView.y=Const.SCENT_HEIGHT/2-this.randomMatchView.height/2,this.addChild(this.randomMatchView),this.randomMatchView.visible=!1,this.prompt=new Prompt,this.addChild(this.prompt),this.prompt.x=Const.SCENT_WIDTH/2-this.prompt.width/2,this.prompt.y=Const.SCENT_HEIGHT/2-this.prompt.height/2+50,this.prompt.visible=!1},e.prototype.getRoomList=function(){if(2===GameData.getRoomListStatus||5===GameData.getRoomListStatus)return console.warn("sdk getRoomListing or warting response"),void console.warn("GameData.getRoomListStatus",GameData.getRoomListStatus);GameData.getRoomListStatus=2;var t=new MsRoomFilter(0,0,0,null);this.mvsGetRoomList(t)},e.prototype.mvsGetRoomList=function(t){var e=MvsManager.getInstance().getRoomList(t);return 0!==e?(GameData.getRoomListStatus=4,void console.error("sdk getRoomList error",e)):(GameData.getRoomListStatus=3,console.log("sdk getRoomList ok",e),void(GameData.getRoomListStatus=5))},e.prototype.mvsGetRoomListResponse=function(t,e){return 200!==t?(GameData.getRoomListStatus=7,void console.error("response getRoomList error",t,e)):(GameData.getRoomListStatus=6,console.log("response getRoomList ok",t,e),void(GameData.isInRoomView!==!0&&GameData.isGameStart!==!0&&this.roomList.freshRoomItem(e)))},e.prototype.avatarClickHandler=function(){GameData.isServerErrorCode1000||this.showProfileView()},e.prototype.showProfileView=function(){this.dMask.visible===!1&&this.profileView.visible===!1&&(this.dMask.visible=!0,this.profileView.visible=!0,GameData.isShowProfileView=!0)},e.prototype.showRandomMatchView=function(){this.dMask.visible===!1&&this.randomMatchView.visible===!1&&(this.dMask.visible=!0,this.randomMatchView.visible=!0,GameData.isShowRandomMatchView=!0)},e.prototype.hideRandomMatchView=function(){this.dMask.visible===!0&&this.randomMatchView.visible===!0&&(this.dMask.visible=!1,this.randomMatchView.visible=!1,GameData.isShowRandomMatchView=!1)},e.prototype.joinRoomBtn1Handler=function(){GameData.isServerErrorCode1000||GameData.isShowProfileView!==!0&&GameData.isShowJoinRoomView!==!0&&(console.log("joinRoomBtn1Handler"),GameData.isQuickJoinBtnClick!==!0&&GameData.isCreateRoomBtnClick!==!0&&GameData.isRoomItemClick!==!0&&GameData.isJoinRoomBtn1Click!==!0&&(GameData.isJoinRoomBtn1Click=!0,this.showJoinRoomView()))},e.prototype.showJoinRoomView=function(){this.dMask.visible===!1&&this.joinRoomView.visible===!1&&(this.dMask.visible=!0,this.joinRoomView.visible=!0,GameData.isShowJoinRoomView=!0)},e.prototype.backToStartView=function(){GameData.isServerErrorCode1000||GameData.isShowProfileView!==!0&&GameData.isShowJoinRoomView!==!0&&GameData.isQuickJoinBtnClick!==!0&&GameData.isCreateRoomBtnClick!==!0&&GameData.isRoomItemClick!==!0&&GameData.isJoinRoomBtn1Click!==!0&&(console.log("backToStartView"),this.resetSomeGameData(),GameData.isInEnterView=!1,GameSceneView._gameScene.start(),this.removeAll())},e.prototype.quickJoinBtnBtnHandler=function(){var t=this;if(!GameData.isServerErrorCode1000&&GameData.isShowProfileView!==!0&&GameData.isShowJoinRoomView!==!0&&(console.log("quickJoinBtnBtnHandler"),GameData.isCreateRoomBtnClick!==!0&&GameData.isJoinRoomBtn1Click!==!0&&GameData.isJoinRoomBtn2Click!==!0&&GameData.isRoomItemClick!==!0))return GameData.isQuickJoinBtnClick===!0?void console.warn("quick join btn has be clicked, please wait response"):(GameData.isQuickJoinBtnClick=!0,2===GameData.joinRandomRoomStatus||5===GameData.joinRandomRoomStatus?(console.warn("sdk joinRandomRooming or wait response"),void console.warn("GameData.joinRandomRoomStatus",GameData.joinRandomRoomStatus)):void setTimeout(function(){GameData.joinRandomRoomStatus=2;var e=2,i=Const.userName;t.mvsJoinRandomRoom(e,i)},200))},e.prototype.mvsJoinRandomRoom=function(t,e){var i=MvsManager.getInstance().joinRandomRoom(t,e);return 0!==i?(GameData.joinRandomRoomStatus=4,void console.warn("sdk joinRandomRoom error",i)):(GameData.joinRandomRoomStatus=3,console.log("sdk joinRandomRoom ok",i),void(GameData.joinRandomRoomStatus=5))},e.prototype.createRoomBtnHandler=function(){var t=this;if(!GameData.isServerErrorCode1000&&GameData.isShowProfileView!==!0&&GameData.isQuickJoinBtnClick!==!0&&GameData.isJoinRoomBtn1Click!==!0&&GameData.isJoinRoomBtn2Click!==!0&&GameData.isRoomItemClick!==!0)return GameData.isCreateRoomBtnClick===!0?void console.warn("create room btn has be clicked, please wait response"):(GameData.isCreateRoomBtnClick=!0,2===GameData.createRoomStatus||5===GameData.createRoomStatus?(console.warn("sdk createRooming or wait response"),void console.warn("GameData.createRoomStatus",GameData.createRoomStatus)):void setTimeout(function(){GameData.createRoomStatus=2;var e=new MsCreateRoomInfo("roomName",2,0,0,0,"roomProperty"),i=Const.userName;t.mvsCreateRoom(e,i)},200))},e.prototype.mvsCreateRoom=function(t,e){var i=MvsManager.getInstance().createRoom(t,e);return 0!==i?(GameData.createRoomStatus=4,void console.warn("sdk createRoom error",i)):(GameData.createRoomStatus=3,console.log("sdk createRoom ok",i),void(GameData.createRoomStatus=5))},e.prototype.mvsCreateRoomResponse=function(t){return 200!==t.status?(console.error("response createRoom error",t),void(GameData.createRoomStatus=7)):(console.log("response createRoom ok",t),GameData.createRoomStatus=6,void(1==GameData.isCreateRoomBtnClick&&(GameData.isInRoomView=!0,GameData.isOwner=!0,GameData.roomId=t.roomId||t.roomID,GameData.ownerId=t.owner,GameData.players[0]={userId:Const.userId,userName:Const.userName,type:"r",score:0,blood:5,isDie:!1},GameData.type="r",this.roomView.showAddRobotBtn(),this.roomView.hideKickPlayerBtn(),this.roomView.showStartGameBtn(),this.roomView.setRoomIdTxt(1,GameData.roomId),this.roomView.setUserName(1,String(Const.userId)),this.showRoomView())))},e.prototype.showRoomView=function(){0==this.roomView.visible&&(this.backBtn.visible=!1,this.quickJoinBtnBtn.visible=!1,this.createRoomBtn.visible=!1,this.joinRoomBtn1.visible=!1,this.profileView.visible=!1,this.joinRoomView.visible=!1,this.dMask.visible=!1,this.roomList.visible=!1,this.roomView.visible=!0)},e.prototype.hideRoomView=function(){1==this.roomView.visible&&(this.backBtn.visible=!0,this.quickJoinBtnBtn.visible=!0,this.createRoomBtn.visible=!0,this.joinRoomBtn1.visible=!0,this.profileView.visible=!1,this.joinRoomView.visible=!1,this.dMask.visible=!1,this.roomList.visible=!0,this.roomView.visible=!1)},e.prototype.joinRoom=function(t){var e=this;setTimeout(function(){GameData.joinRoomStatus=2;var i="";e.mvsJoinRoom(t,i)},200)},e.prototype.mvsJoinRoom=function(t,e){var i=MvsManager.getInstance().joinRoom(t,e);return 0!==i?(GameData.joinRoomStatus=4,void console.error("sdk joinRoom error",i)):(GameData.joinRoomStatus=3,console.log("sdk joinRoom ok",i),void(GameData.joinRoomStatus=5))},e.prototype.mvsJoinRoomResponse=function(t,e,i){return 200!==t?void(GameData.isQuickJoinBtnClick===!0?(GameData.joinRandomRoomStatus=7,console.error("response joinRandomRoom error",t)):(GameData.isJoinRoomBtn2Click===!0||GameData.isRoomItemClick===!0)&&(GameData.joinRoomStatus=7,console.error("response joinRoom error",t))):(GameData.isQuickJoinBtnClick===!0?(GameData.joinRandomRoomStatus=6,console.log("response joinRandomRoom ok",t)):(GameData.isJoinRoomBtn2Click===!0||GameData.isRoomItemClick===!0)&&(GameData.joinRoomStatus=6,console.log("response joinRoom ok",t)),GameData.isQuickJoinBtnClick?0===e.length?(GameData.players[0]={userId:Const.userId,userName:Const.userName,type:"r",score:0,blood:5,isDie:!1},GameData.type="r",GameData.isOwner=!0,GameData.roomId=i.roomId||i.roomID,GameData.ownerId=i.ownerId,this.showRandomMatchView(),this.randomMatchView.tickTop()):1===e.length?(GameData.players[0]={userId:e[0].userId,userName:e[0].userProfile,type:"r",score:0,blood:5,isDie:!1},GameData.players[1]={userId:Const.userId,userName:Const.userName,type:"b",score:0,blood:5,isDie:!1},GameData.roomId=i.roomId||i.roomID,GameData.ownerId=i.ownerId,GameData.type="b",GameData.isOwner=!1):console.error("mvsJoinRoomResponse length error, userInfoList.length",e.length):(GameData.isJoinRoomBtn2Click===!0||GameData.isRoomItemClick===!0)&&(GameData.isInRoomView=!0,1===e.length?(GameData.players[0]={userId:e[0].userId,userName:e[0].userProfile,type:"r",score:0,blood:5,isDie:!1},GameData.players[1]={userId:Const.userId,userName:Const.userName,type:"b",score:0,blood:5,isDie:!1},GameData.type="b",GameData.isOwner=!1,GameData.roomId=i.roomId||i.roomID,GameData.ownerId=i.ownerId,this.roomView.hideAddRobotBtn(),this.roomView.hideKickPlayerBtn(),this.roomView.hideStartGameBtn(),this.roomView.setRoomIdTxt(1,GameData.roomId),this.roomView.setUserName(1,String(GameData.players[0].userId)),this.roomView.setUserName(2,String(Const.userId)),this.showRoomView()):console.error("mvsJoinRoomResponse length error, userInfoList.length",e.length)),console.warn("mvsJoinRoomResponse GameData.players",GameData.players),void console.warn("mvsJoinRoomResponse GameData.type",GameData.type))},e.prototype.mvsJoinRoomNotify=function(t){if(GameData.isQuickJoinBtnClick){if(1===GameData.players.length?GameData.players[1]={userId:t.userId,userName:t.userProfile,type:"b",score:0,blood:5,isDie:!1}:console.error("mvsJoinRoomNotify length error, GameData.players.length",GameData.players.length),GameData.players.length>=2&&GameData.isOwner){var e="",i=MvsManager.getInstance().joinOver(e);if(0!==i)return void console.error("joinOver error",i);console.warn("joinOver ok",i)}}else(GameData.isCreateRoomBtnClick||GameData.isJoinRoomBtn2Click||GameData.isRoomItemClick)&&(1===GameData.players.length?(GameData.players[1]={userId:t.userId,userName:t.userProfile,type:"b",score:0,blood:5,isDie:!1},this.roomView.hideAddRobotBtn(),this.roomView.showKickPlayerBtn(),this.roomView.setUserName(2,String(GameData.players[1].userId))):console.error("mvsJoinRoomNotify length error, GameData.players.length",GameData.players.length));console.warn("mvsJoinRoomNotify GameData.players",GameData.players),console.warn("mvsJoinRoomNotify GameData.type",GameData.type)},e.prototype.joinOver=function(){GameData.joinOverStatus=2;var t="";this.mvsJoinOver(t)},e.prototype.mvsJoinOver=function(t){var e=MvsManager.getInstance().joinOver(t);return 0!==e?(GameData.joinOverStatus=4,void console.error("sdk joinOver error",e)):(GameData.joinOverStatus=3,console.warn("sdk joinOver ok",e),void(GameData.joinOverStatus=5))},e.prototype.mvsSendEventResponse=function(t){var e=t.status;return 200!=e?void console.error("mvsSendEventResponse error",t):(console.warn("mvsSendEventResponse ok",t),void this.gameWillPlay())},e.prototype.mvsSendEventNotify=function(t){var e=JSON.parse(t.cpProto),i=e.event;i===Const.GAME_WILL_PLAY_EVENT?this.gameWillPlay():console.error("GameEnter mvsSendEventNotify",t)},e.prototype.mvsSetFrameSyncResponse=function(t){return 200!==t.mStatus?(GameData.setFrameStatus=7,void console.error("mvsSetFrameSyncResponse error",t)):(GameData.setFrameStatus=6,console.warn("mvsSetFrameSyncResponse ok",t),GameData.isAddRobot===!0?void this.gameWillPlay():void setTimeout(function(){var t=JSON.stringify({event:Const.GAME_WILL_PLAY_EVENT}),e=MvsManager.getInstance().sendEvent(t);return 0!==e.result?void console.error("sendEvent error",e):void console.warn("sendEvent ok",e)},200))},e.prototype.gameWillPlayWithRobot=function(){this.joinOver()},e.prototype.mvsJoinOverResponse=function(t){return 200!==t.status?(GameData.joinOverStatus=7,void console.error("response joinOverResponse error",t)):(GameData.joinOverStatus=6,console.warn("response joinOverResponse ok",t),void setTimeout(function(){if(!(GameData.setFrameStatus>1)){GameData.setFrameStatus=2;var t=MvsManager.getInstance().setFrameSync(10);if(0!==t)return GameData.setFrameStatus=4,void console.error("setFrameSync error",t);GameData.setFrameStatus=3,console.warn("setFrameSync ok",t),GameData.setFrameStatus=5}},200))},e.prototype.gameWillPlay=function(){GameData.isInEnterView=!1,GameData.lastRoomId=GameData.roomId,this.dispose(),GameSceneView._gameScene.play(),this.removeAll()},e.prototype.dispose=function(){this.mvsUnBind()},e.prototype.removeAll=function(){this.removeChildren(),this.parent&&this.parent.removeChild(this)},e.prototype.kickPlayer=function(t){var e="";this.mvsKickPlayer(t,e)},e.prototype.mvsKickPlayer=function(t,e){setTimeout(function(){var i=MvsManager.getInstance().kickPlayer(t,e);return 0!==i?void console.error("sdk kickPlayer error",i):void console.warn("sdk kickPlayer ok",i)},200)},e.prototype.mvsKickPlayerResponse=function(t){var e=t.status;return 200!==e?void console.error("response kickPlayerResponse error",t):(console.warn("response kickPlayerResponse ok",t),GameData.players.splice(1,1),this.roomView.hideKickPlayerBtn(),this.roomView.showAddRobotBtn(),void this.roomView.setUserName(2,"--"))},e.prototype.mvsKickPlayerNotify=function(t){var e=t.UserId||t.userId;t.cpProto,t.srcUserId;e==Const.userId&&(this.roomView.setRoomIdTxt(2),this.roomView.setUserName(3),this.resetSomeGameData(),this.hideRoomView())},e.prototype.resetSomeGameData=function(){GameData.isQuickJoinBtnClick=!1,GameData.isCreateRoomBtnClick=!1,GameData.isJoinRoomBtn1Click=!1,GameData.isJoinRoomBtn2Click=!1,GameData.isRoomItemClick=!1,GameData.isLeaveRoomBtnClick=!1,GameData.isLeaveRoomBtn2Click=!1,GameData.isShowProfileView=!1,GameData.isShowJoinRoomView=!1,GameData.isAddRobot=!1,GameData.isOwner=!1,GameData.ownerId=0,GameData.lastRoomId="",GameData.roomId="",GameData.players=[],GameData.type="",GameData.isInRoomView=!1,GameData.createRoomStatus=1,GameData.joinRandomRoomStatus=1,GameData.joinRoomStatus=1,GameData.leaveRoomStatus=1,GameData.joinOverStatus=1,GameData.logoutStatus=1,GameData.getRoomListStatus=1,GameData.kickPlayerStatus=1,GameData.setFrameStatus=1,GameData.isGameStart=!1,GameData.isGameOver=!1,GameData.isWin=!1},e.prototype.leaveRoom=function(){var t="";this.mvsLeaveRoom(t)},e.prototype.mvsLeaveRoom=function(t){setTimeout(function(){var e=MvsManager.getInstance().leaveRoom(t);return 0!==e?void console.error("sdk leaveRoom error",e):void console.warn("sdk leaveRoom ok",e)},200)},e.prototype.mvsLeaveRoomResponse=function(t){var e=t.status;return 200!==e?void console.error("response leaveRoom  error",t):(console.warn("response leaveRoom ok",t),GameData.isQuickJoinBtnClick===!0&&(this.resetSomeGameData(),this.randomMatchView.closeTickTop(),this.hideRandomMatchView()),void((GameData.isJoinRoomBtn2Click===!0||GameData.isCreateRoomBtnClick===!0||GameData.isRoomItemClick===!0)&&(this.roomView.setRoomIdTxt(2),this.roomView.setUserName(3),this.resetSomeGameData(),this.hideRoomView())))},e.prototype.mvsLeaveRoomNotify=function(t){var e=t.userId,i=t.owner;GameData.isQuickJoinBtnClick===!0?(console.error("此时按照策划设计, 不应该有人离开房间"),console.error("如果离开了, 是不合理的")):(GameData.isJoinRoomBtn2Click===!0||GameData.isCreateRoomBtnClick===!0||GameData.isRoomItemClick===!0)&&(e==GameData.ownerId&&i==Const.userId?(GameData.players[0]=GameData.players[1],GameData.players[0].type="r",GameData.players.splice(1,1),GameData.type="r",GameData.isOwner=!0,GameData.ownerId=i,this.roomView.showStartGameBtn(),this.roomView.showAddRobotBtn(),this.roomView.setUserName(1,String(Const.userId)),this.roomView.setUserName(2,"--")):e!=GameData.ownerId&&(GameData.players.splice(1,1),this.roomView.setUserName(2,"--")),this.roomView.hideKickPlayerBtn(),this.roomView.showAddRobotBtn())},e.prototype.loadAvatar=function(){this.loadCompleteHandler()},e.prototype.loadCompleteHandler=function(){var t=ResourceUtils.createBitmapByName("avatar_png");t.width=65,t.height=65,this.avatarPng.addChild(t)
},e.prototype.mvsErrorResponse=function(t,e){console.error("mvsErrorResponse",arguments),GameData.joinRoomStatus=1,this.resetSomeGameData(),1e3===t?(GameData.isServerErrorCode1000=!0,this.showPromptOfError("你已掉线 请刷新 重开")):404===t&&this.showPrompt("该房间不能加入")},e.prototype.showPromptOfError=function(t){this.prompt.alpha=1,this.prompt.visible=!0,this.prompt.setValue(t)},e}(egret.Sprite);__reflect(GameEnterView.prototype,"GameEnterView");var GameOverView=function(t){function e(){var e=t.call(this)||this;return e.mvsBind(),e.leaveRoom(),e.initView(),e}return __extends(e,t),e.prototype.mvsBind=function(){MvsManager.response.leaveRoomResponse=this.mvsLeaveRoomResponse.bind(this),MvsManager.response.leaveRoomNotify=this.mvsLeaveRoomNotify.bind(this),MvsManager.response.errorResponse=this.mvsErrorResponse.bind(this)},e.prototype.mvsErrorResponse=function(t,e){console.error("errorResponse",arguments),1e3===t&&(GameData.isServerErrorCode1000=!0,this.showPromptOfError("你已掉线 请刷新 重开"))},e.prototype.showPromptOfError=function(t){this.prompt.alpha=1,this.prompt.visible=!0,this.prompt.setValue(t)},e.prototype.mvsUnBind=function(){MvsManager.response.leaveRoomResponse=null,MvsManager.response.leaveRoomNotify=null,MvsManager.response.errorResponse=null},e.prototype.initView=function(){this.thisContainer=new egret.Sprite,this.addChild(this.thisContainer);var t=0,e="r"==GameData.type?GameData.players[0].score:GameData.players[1].score;GameData.players[0].score>GameData.players[1].score?"r"==GameData.type?(GameData.isWin=!0,t=100):"b"==GameData.type&&(GameData.isWin=!1,t=20):GameData.players[0].score<GameData.players[1].score?"r"==GameData.type?(GameData.isWin=!1,t=20):"b"==GameData.type&&(GameData.isWin=!0,t=100):(GameData.isWin=!1,t=50),GameData.allValue++,GameData.isWin?(SoundUtils.instance().playWin(),GameData.winValue++):SoundUtils.instance().playOver(),GameData.gold+=t,this.bg=ResourceUtils.createBitmapByName("overBgImage"),this.thisContainer.addChild(this.bg),this.bg.x=Const.SCENT_WIDTH/2-this.bg.width/2,this.bg.y=Const.SCENT_HEIGHT/2-this.bg.height/2,GameData.isWin?this.iconWinOrLose=ResourceUtils.createBitmapByName("icon_win_png"):this.iconWinOrLose=ResourceUtils.createBitmapByName("icon_lose_png"),this.iconWinOrLose.x=Const.SCENT_WIDTH/2-this.iconWinOrLose.width/2,this.iconWinOrLose.y=this.bg.y+209,this.thisContainer.addChild(this.iconWinOrLose);var i=new egret.TextField;i.text="本局分数",i.size=20,i.textColor=3355443,i.fontFamily="Microsoft YaHei UI",i.x=Const.SCENT_WIDTH/4-i.width/2,i.y=this.bg.y+324,this.thisContainer.addChild(i);var o=new egret.TextField;o.text=e+"",o.size=35,o.textColor=15360512,o.fontFamily="Microsoft YaHei UI",o.x=Const.SCENT_WIDTH/4-o.width/2,o.y=i.y+i.height+15,this.thisContainer.addChild(o);var a=new egret.TextField;a.text="获得金币",a.size=20,a.textColor=3355443,a.fontFamily="Microsoft YaHei UI",a.x=Const.SCENT_WIDTH/4*3-a.width/2,a.y=i.y,this.thisContainer.addChild(a);var s=new egret.TextField;s.text=t+"",s.size=35,s.textColor=15360512,s.fontFamily="Microsoft YaHei UI",s.x=Const.SCENT_WIDTH/4*3-s.width/2,s.y=a.y+a.height+15,this.thisContainer.addChild(s);var n=new egret.Sprite;this.thisContainer.addChild(n),this.backHomeBtn=ResourceUtils.createBitmapByName("btn_backToHome_png"),this.backHomeBtn.touchEnabled=!0,this.backHomeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.toGameEnterView,this),this.backHomeBtn.x=Const.SCENT_WIDTH/2-this.backHomeBtn.width/2,this.backHomeBtn.y=this.bg.y+489,n.addChild(this.backHomeBtn),this.prompt=new Prompt,this.addChild(this.prompt),this.prompt.x=Const.SCENT_WIDTH/2-this.prompt.width/2,this.prompt.y=Const.SCENT_HEIGHT/2-this.prompt.height/2,this.prompt.visible=!1},e.prototype.toGameEnterView=function(){GameData.isServerErrorCode1000||(this.dispose(),GameSceneView._gameScene.enter())},e.prototype.dispose=function(){this.backHomeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.toGameEnterView,this),this.mvsUnBind(),this.resetSomeGameData(),this.removeAll()},e.prototype.resetSomeGameData=function(){GameData.isQuickJoinBtnClick=!1,GameData.isCreateRoomBtnClick=!1,GameData.isJoinRoomBtn1Click=!1,GameData.isJoinRoomBtn2Click=!1,GameData.isRoomItemClick=!1,GameData.isLeaveRoomBtnClick=!1,GameData.isLeaveRoomBtn2Click=!1,GameData.isShowProfileView=!1,GameData.isShowJoinRoomView=!1,GameData.isAddRobot=!1,GameData.isOwner=!1,GameData.ownerId=0,GameData.lastRoomId="",GameData.roomId="",GameData.players=[],GameData.type="",GameData.gameTime=600,GameData.isInRoomView=!1,GameData.createRoomStatus=1,GameData.joinRandomRoomStatus=1,GameData.joinRoomStatus=1,GameData.leaveRoomStatus=1,GameData.joinOverStatus=1,GameData.logoutStatus=1,GameData.getRoomListStatus=1,GameData.kickPlayerStatus=1,GameData.setFrameStatus=1,GameData.isGameStart=!1,GameData.isGameOver=!1,GameData.isWin=!1,GameData.enemyNum=0,GameData.profectNum=0,GameData.langNum=0},e.prototype.leaveRoom=function(){GameData.leaveRoomStatus=2;var t="";this.mvsLeaveRoom(t)},e.prototype.mvsLeaveRoom=function(t){var e=MvsManager.engine.leaveRoom(t);return 0!==e?(GameData.leaveRoomStatus=4,void console.error("sdk leaveRoom error",e)):(GameData.leaveRoomStatus=3,console.warn("sdk leaveRoom ok",e),void(GameData.leaveRoomStatus=5))},e.prototype.mvsLeaveRoomResponse=function(t){return 200!==t.status?(GameData.leaveRoomStatus=7,void console.error("response leaveRoom error",t)):(GameData.leaveRoomStatus=6,void console.warn("response leaveRoom ok",t))},e.prototype.mvsLeaveRoomNotify=function(){},e.prototype.removeAll=function(){this.removeChildren(),this.parent&&this.parent.removeChild(this)},e}(egret.Sprite);__reflect(GameOverView.prototype,"GameOverView");var GamePlayView=function(t){function e(){var e=t.call(this)||this;return e.mvsBind(),e.sp=new egret.Sprite,e.sp.touchEnabled=!0,e.addChild(e.sp),e}return __extends(e,t),e.prototype.mvsBind=function(){MvsManager.response.leaveRoomResponse=this.mvsLeaveRoomResponse.bind(this),MvsManager.response.leaveRoomNotify=this.mvsLeaveRoomNotify.bind(this),MvsManager.response.errorResponse=this.mvsErrorResponse.bind(this),MvsManager.response.networkStateNotify=this.mvsNetworkStateNotify.bind(this)},e.prototype.mvsUnBind=function(){MvsManager.response.leaveRoomResponse=null,MvsManager.response.leaveRoomNotify=null,MvsManager.response.errorResponse=null,MvsManager.response.networkStateNotify=null},e.prototype.mvsErrorResponse=function(t,e){console.error("mvsErrorResponse",arguments),1e3===t&&(GameData.isServerErrorCode1000=!0,this.showPromptOfError("你已掉线 请刷新 重开"))},e.prototype.showPromptOfError=function(t){this.prompt.alpha=1,this.prompt.visible=!0,this.prompt.setValue(t)},e.prototype.mvsNetworkStateNotify=function(t){var e={userId:t.userID,state:t.state,roomId:t.roomID,ownerId:t.owner};1===e.state&&this.showPrompt("有玩家掉线")},e.prototype.showPrompt=function(t){this.prompt.alpha=1,this.prompt.visible=!0,this.prompt.setValue(t),egret.Tween.get(this.prompt).to({alpha:0,visible:!1},2e3)},e.prototype.showGame=function(){GameData.isGameStart=!1,this.sp.removeChildren(),this.gameFightView=new GameFightView,this.sp.addChild(this.gameFightView);var t=new egret.Sprite,e=ResourceUtils.createBitmapByName("optionBtnImage");t.addChild(e),t.touchEnabled=!0,t.width=38,t.height=38,t.x=431,t.y=748,t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showOptionView,this),this.addChild(t),this.optionView=new OptionView(Const.IN_PLAY_VIEW,this),this.addChild(this.optionView),this.optionView.visible=!1,this.ready=StarlingSwfFactory.getInstance().makeMc("go"),this.ready.x=Const.SCENT_WIDTH/2,this.ready.y=Const.SCENT_HEIGHT/2,this.addChild(this.ready),this.ready.goToPlay("1"),SoundUtils.instance().playNum(),this.ready.setCompleteAction(this.complete1,this),this.prompt=new Prompt,this.addChild(this.prompt),this.prompt.x=Const.SCENT_WIDTH/2-this.prompt.width/2,this.prompt.y=Const.SCENT_HEIGHT/2-this.prompt.height/2,this.prompt.visible=!1},e.prototype.showOptionView=function(){this.optionView.visible=!0},e.prototype.complete1=function(){this.ready.goToPlay("2"),SoundUtils.instance().playGo(),egret.setTimeout(this.complete2.bind(this),this,300)},e.prototype.complete2=function(){GameData.isGameStart=!0,SoundUtils.instance().playBg(),this.removeChild(this.ready)},e.prototype.leaveRoom=function(){if(!GameData.isLeaveRoomBtnClick){GameData.isLeaveRoomBtnClick=!0;var t="";this.mvsLeaveRoom(t)}},e.prototype.mvsLeaveRoom=function(t){setTimeout(function(){var e=MvsManager.getInstance().leaveRoom(t);return 0!==e?void console.error("sdk leaveRoom error",e):void console.warn("sdk leaveRoom ok",e)},200)},e.prototype.mvsLeaveRoomResponse=function(t){var e=t.status;return 200!==e?void console.error("response leaveRoom error",t):(console.warn("response leaveRoom ok",t),this.resetSomeGameData(),SoundUtils.instance().stopBg(),this.mvsUnBind(),this.gameFightView.mvsUnBind(),this.gameFightView.dispose(),void GameSceneView._gameScene.enter())},e.prototype.resetSomeGameData=function(){GameData.isQuickJoinBtnClick=!1,GameData.isCreateRoomBtnClick=!1,GameData.isJoinRoomBtn1Click=!1,GameData.isJoinRoomBtn2Click=!1,GameData.isRoomItemClick=!1,GameData.isLeaveRoomBtnClick=!1,GameData.isLeaveRoomBtn2Click=!1,GameData.isShowProfileView=!1,GameData.isShowJoinRoomView=!1,GameData.isAddRobot=!1,GameData.isOwner=!1,GameData.ownerId=0,GameData.lastRoomId="",GameData.roomId="",GameData.players=[],GameData.type="",GameData.gameTime=600,GameData.isInRoomView=!1,GameData.createRoomStatus=1,GameData.joinRandomRoomStatus=1,GameData.joinRoomStatus=1,GameData.leaveRoomStatus=1,GameData.joinOverStatus=1,GameData.logoutStatus=1,GameData.getRoomListStatus=1,GameData.kickPlayerStatus=1,GameData.setFrameStatus=1,GameData.isGameStart=!1,GameData.isGameOver=!1,GameData.isWin=!1,GameData.enemyNum=0,GameData.profectNum=0,GameData.langNum=0},e.prototype.mvsLeaveRoomNotify=function(t,e){console.warn("notify leaveRoomNotify",t,e)},e}(egret.Sprite);__reflect(GamePlayView.prototype,"GamePlayView");var GameSceneView=function(t){function e(){var i=t.call(this)||this;return e._gameScene=i,i.initView(),i}return __extends(e,t),e.prototype.initView=function(){this.thisContainer=new egret.Sprite,this.addChild(this.thisContainer),this.start()},e.prototype.start=function(){this.removeAll();var t=new GameStartView;this.thisContainer.addChild(t)},e.prototype.enter=function(){this.removeAll(),GameData.isInEnterView=!0;var t=new GameEnterView;this.thisContainer.addChild(t)},e.prototype.play=function(){this.removeAll();var t=new GamePlayView;this.thisContainer.addChild(t),t.showGame()},e.prototype.over=function(){this.removeAll();var t=new GameOverView;this.thisContainer.addChild(t)},e.prototype.removeAll=function(){this.thisContainer.removeChildren()},e}(egret.Sprite);__reflect(GameSceneView.prototype,"GameSceneView");var GameStartView=function(t){function e(){var e=t.call(this)||this;return e.initView(),e.mvsBind(),0===Const.userId&&e.registerUser(),e}return __extends(e,t),e.prototype.mvsBind=function(){MvsManager.response.registerUserResponse=this.mvsRegisterUserResponse.bind(this),MvsManager.response.loginResponse=this.mvsLoginResponse.bind(this),MvsManager.response.errorResponse=this.mvsErrorResponse.bind(this)},e.prototype.mvsErrorResponse=function(t,e){console.error("mvsErrorResponse",arguments),1e3===t&&(GameData.isServerErrorCode1000=!0,this.showPromptOfError("你已掉线 请刷新 重开"))},e.prototype.showPromptOfError=function(t){this.prompt.visible=!0,this.prompt.setValue(t)},e.prototype.registerUser=function(){return 2===GameData.registerStatus||5===GameData.registerStatus?(console.warn("sdk registering or waiting response"),void console.warn("GameData.registerStatus",GameData.registerStatus)):(GameData.registerStatus=2,void this.mvsRegisterUser())},e.prototype.mvsRegisterUser=function(){var t=MvsManager.getInstance().registerUser();return 0!==t?(GameData.registerStatus=4,void console.error("sdk registerUser error",t)):(GameData.registerStatus=3,console.log("sdk registerUser ok",t),void(GameData.registerStatus=5))},e.prototype.initView=function(){var t=ResourceUtils.createBitmapByName("bgImage");t.width=Const.SCENT_WIDTH,t.height=Const.SCENT_HEIGHT,this.addChild(t);var e=new MyButtonForGame("startBtnImage","startBtnImage");this.addChild(e),e.x=Const.SCENT_WIDTH/2-e.width/2,e.y=Const.SCENT_HEIGHT-e.height-30,e.setClick(this.onStartGameHandler.bind(this));var i=new MyButtonForGame("musicBtnImage","musicBtnImage");this.addChild(i),i.x=e.x+e.width+10,i.y=e.y+10,i.setClick(this.showGameSoundHandler.bind(this)),this.optionView=new OptionView(Const.IN_START_VIEW),this.addChild(this.optionView),this.optionView.visible=!1,this.prompt=new Prompt,this.addChild(this.prompt),this.prompt.x=Const.SCENT_WIDTH/2-this.prompt.width/2,this.prompt.y=Const.SCENT_HEIGHT/2-this.prompt.height/2,this.prompt.visible=!1},e.prototype.showGameSoundHandler=function(t){GameData.isServerErrorCode1000||(this.optionView.visible=!0)},e.prototype.showGameInfoHandler=function(t){this.removeAll()},e.prototype.onStartGameHandler=function(){GameData.isServerErrorCode1000||(1===GameData.loginStatus?console.error("还未开始登录"):2===GameData.loginStatus||5===GameData.loginStatus?(console.warn("please wait matchvs init"),console.warn("GameData.loginStatus",GameData.loginStatus)):3===GameData.loginStatus||(4===GameData.loginStatus||7===GameData.loginStatus?(console.error("登录失败"),console.error("GameData.loginStatus",GameData.loginStatus)):6===GameData.loginStatus&&(GameSceneView._gameScene.enter(),this.removeAll())))},e.prototype.onLeaveGameHandler=function(){console.log("退出游戏")},e.prototype.mvsRegisterUserResponse=function(t){return t?(GameData.registerStatus=6,console.log("response register user ok",t),Const.userId=t.id,Const.token=t.token,Const.userName=t.name,Const.avatarUrl=t.avatar,void this.login()):(GameData.registerStatus=7,void console.error("response register user error",t))},e.prototype.login=function(){return 2===GameData.loginStatus||5===GameData.loginStatus?(console.warn("sdk logining or waiting response"),void console.warn("GameData.loginStatus",GameData.loginStatus)):(GameData.loginStatus=2,void this.mvsLogin())},e.prototype.mvsLogin=function(){var t=MvsManager.getInstance().login();return 0!==t?(GameData.loginStatus=4,void console.error("sdk login error",t)):(GameData.loginStatus=3,console.log("sdk login ok",t),void(GameData.loginStatus=5))},e.prototype.mvsLoginResponse=function(t){return 200!==t.status?(GameData.loginStatus=7,void console.error("response login error",t)):(GameData.loginStatus=6,void console.log("response login  ok",t))},e.prototype.removeAll=function(){this.removeChildren()},e}(egret.Sprite);__reflect(GameStartView.prototype,"GameStartView");var GameFightView=function(t){function e(){var i=t.call(this)||this;return i.shanBoo=!1,i.reliveTime=0,i.timeBoo=0,i.timeBooRobot=0,i.oneEnemyArr=[],i.twoEnemyArr=[],i.threeEnemyArr=[],i.fourEnemyArr=[],i.btnArr=[],i.btnClickArr=[],i.isFire=!1,i.btnY=0,i.widthPoint=0,i.popArr=[],i.streakWin=0,i.bombArr=[],"r"===GameData.type?i.timeBoo=0:"b"===GameData.type&&(i.timeBoo=-30),GameData.isAddRobot===!0&&(i.timeBooRobot=-30),e.allArr=[i.oneEnemyArr,i.twoEnemyArr,i.threeEnemyArr,i.fourEnemyArr],i.btnClickArr=[0,0,0,0],i.initView(),i.initLayer(),i.initBomb(),egret.Ticker.getInstance().register(i.onFrameHandler,i),GameData.isAddRobot&&i.robotAuto(),i.mvsBind(),i}return __extends(e,t),e.prototype.robotAuto=function(){},e.prototype.mvsBind=function(){MvsManager.response.frameUpdate=this.mvsFrameUpdate.bind(this),MvsManager.response.sendFrameEventResponse=function(t){200===t.mStatus||console.error("response sendFrameEvent",arguments)}},e.prototype.mvsUnBind=function(){MvsManager.response.frameUpdate=null,MvsManager.response.sendFrameEventResponse=null},e.prototype.initView=function(){this.bg=new BgView,this.addChild(this.bg),this.bg.initView()},e.prototype.initLayer=function(){this.enemySp=new egret.Sprite,this.addChild(this.enemySp),this.uiSp=new egret.Sprite,this.addChild(this.uiSp),this.bombSp=new egret.Sprite,this.addChild(this.bombSp),this.shan=ResourceUtils.createBitmapByName("shanImage"),this.addChild(this.shan),this.shan.visible=!1,this.reliveBtn=new ReliveBtn,this.addChild(this.reliveBtn),this.reliveBtn.x=Const.SCENT_WIDTH/2-this.reliveBtn.width/2,this.reliveBtn.y=Const.SCENT_HEIGHT/2-this.reliveBtn.height/2,this.reliveBtn.visible=!1,this.reliveBtn.setClick(this.onReliveBtnHandler.bind(this)),this.redGirl1=new RedGirl("r"),this.redGirl1.x=Const.SCENT_WIDTH/2-60,this.redGirl1.y=Const.SCENT_HEIGHT-50,this.addChild(this.redGirl1),this.redGirl2=new RedGirl("b"),this.redGirl2.x=Const.SCENT_WIDTH/2+60,this.redGirl2.y=Const.SCENT_HEIGHT-50,this.addChild(this.redGirl2),this.arrow=ResourceUtils.createBitmapByName("arrow_png"),this.arrow.width/=2,this.arrow.height/=2,"r"===GameData.type?this.arrow.x=163:"b"===GameData.type&&(this.arrow.x=284),this.arrow.y=630,this.addChild(this.arrow);for(var t=0,e=4;e>t;t++){var i=new FightButton;i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBegin,this),i.addEventListener(egret.TouchEvent.TOUCH_END,this.onEnd,this),this.uiSp.addChild(i),i.x=t*(i.width+14)+10,i.y=500,i.name=t+"",this.widthPoint=i.width/2,this.btnY=i.y+2*this.widthPoint,this.btnArr.push(i)}this.blodBar1=new BlodBar("r"),this.uiSp.addChild(this.blodBar1),this.blodBar1.x=11,this.blodBar1.y=53,this.blodBar2=new BlodBar("b"),this.uiSp.addChild(this.blodBar2),this.blodBar2.x=302,this.blodBar2.y=53,this.gameTime=new SpecialNumber("number-0"),this.uiSp.addChild(this.gameTime),this.gameTime.setValue("60"),this.gameTime.x=Const.SCENT_WIDTH/2-this.gameTime.width/2,this.gameTime.y=40,this.score1=new SpecialNumber("number-"),this.uiSp.addChild(this.score1),this.score1.setValue("0"),this.score1.x=this.blodBar1.x+this.blodBar1.width/2-this.score1.width/2,this.score1.y=19,this.score2=new SpecialNumber("number-"),this.uiSp.addChild(this.score2),this.score2.setValue("0"),this.score2.x=this.blodBar2.x+this.blodBar2.width/2-this.score2.width/2,this.score2.y=19,this.goldView=new GoldView,this.uiSp.addChild(this.goldView),this.goldView.x=15,this.goldView.y=754,this.goldView.setValue(GameData.gold+""),this.streakWinNum=new StreakNum,this.streakWinNum.x=Const.SCENT_WIDTH/2-this.streakWinNum.width/2,this.streakWinNum.y=125,this.addChild(this.streakWinNum),this.streakWinNum.visible=!1,t=0,e=10;for(var o;e>t;t++)o=new PromptPop,o.activate(Const.SCENT_WIDTH/2-100,Const.SCENT_HEIGHT-300,o.config),this.addChild(o),this.popArr.push(o)},e.prototype.initBomb=function(){for(var t,e=0,i=10;i>e;e++)t=new Bomb,this.bombSp.addChild(t),t.visible=!1,this.bombArr.push(t)},e.prototype.popProm=function(t){void 0===t&&(t="");for(var e=0,i=this.popArr.length;i>e;e++)if(0==this.popArr[e].targetMc.visible){this.popArr[e].show(t);break}},e.prototype.willInitEnemy=function(){var t=GameData.type,e=Math.floor(4*Math.random()),i=++GameData.enemyNum,o=t+"_"+e+"_"+i,a=JSON.stringify({event:Const.WILL_INIT_ENEMY_EVENT,name:o}),s=MvsManager.getInstance().sendFrameEvent(a);0===s||console.error("sendFrameEvent WILL_INIT_ENEMY_EVENT error",s)},e.prototype.willInitEnemyByRobot=function(){var t=this,e="b",i=Math.floor(4*Math.random()),o=GameData.enemyNum,a=e+"_"+i+"_"+o,s=JSON.stringify({event:Const.WILL_INIT_ENEMY_EVENT,name:a}),n=MvsManager.getInstance().sendFrameEvent(s);if(0===n||console.error("sendFrameEvent WILL_INIT_ENEMY_EVENT error",n),Math.random()>.6){if(GameData.players[1].isDie)return;setTimeout(function(){t.hitOver({name:a,type:"b",index:i,rank:1,score:30})},1500)}},e.prototype.initEnemy=function(t){var e=t.name,i=e.split("_"),o=i.slice(),a=o[0],s=o[1],n=(o[2],new Enemy(a));this.enemySp.addChild(n);var r=Number(s);n.row=r,n.x=this.btnArr[r].x+this.widthPoint,n.y=0,n.type=a,n.name=e,this.pushEnemy(r,n)},e.prototype.pushEnemy=function(t,e){0===t?this.oneEnemyArr.push(e):1===t?this.twoEnemyArr.push(e):2==t?this.threeEnemyArr.push(e):3==t&&this.fourEnemyArr.push(e)},e.prototype.enemiesMoveOrStop=function(){GameData.isGameStart&&!GameData.isGameOver&&(this.enemyMoveOrStop(this.oneEnemyArr),this.enemyMoveOrStop(this.twoEnemyArr),this.enemyMoveOrStop(this.threeEnemyArr),this.enemyMoveOrStop(this.fourEnemyArr))},e.prototype.enemyMoveOrStop=function(t){if(0!=t.length)for(var e=t.length,i=0;e>i;e--)if(t[e-1].over===!1&&t[e-1].move(),(t[e-1].x<-t[e-1].width||t[e-1].x>t[e-1].width/2+Const.SCENT_WIDTH)&&(t[e-1].over=!0),t[e-1].over===!0){if(t[e-1].dispose(),this.enemySp.removeChild(t[e-1]),t.splice(e-1,1),0==t.length)return}else if(t[e-1].guo===!1&&t[e-1].y>this.btnY+this.widthPoint/2){var o=t[e-1].name,a=t[e-1].row,s=t[e-1].type;this.missFun(o,s,a)}},e.prototype.mvsFrameUpdate=function(t){if(GameData.isGameStart){if(GameData.gameTime<=0)return void(GameData.isGameOver=!0);this.gameTime.setValue(Math.floor(GameData.gameTime/10)+""),this.gameTime.x=Const.SCENT_WIDTH/2-this.gameTime.width/2,GameData.gameTime--;for(var e=t.frameItems,i=0;i<e.length;i++){var o=JSON.parse(e[i].cpProto),a=o.event;a===Const.WILL_INIT_ENEMY_EVENT&&this.initEnemy(o),a===Const.MISS_FUN_EVENT&&this.missOver(o),a===Const.ACC_HIT_FUN_EVENT&&this.accHitOver(o),a===Const.HIT_FUN_EVENT&&this.hitOver(o),a===Const.RELIVE_EVENT&&this.changeBlood(o,Const.RELIVE_ACTION)}this.enemiesMoveOrStop()}},e.prototype.onBegin=function(t){if(t.preventDefault(),!("r"===GameData.type&&GameData.players[0].isDie===!0||"b"===GameData.type&&GameData.players[1].isDie===!0)){for(var e=t.currentTarget.name,i=e,o=0;4>o;o++)o!==e&&1===this.btnClickArr[o]&&this.btnArr[o].goPlay(0);this.btnClickArr[e]=1,this.fire(t.currentTarget),this.hitTestObj(e,i),t.currentTarget.goPlay(1)}},e.prototype.hitTestObj=function(t,i){for(var o=e.allArr[i],a=this.btnArr[t],s=o.length,n=0;s>n;n++)if(!(o[n].y<a.y)&&o[n].y<=a.y+2*this.widthPoint){this.bTitTest(a,o[n],o,i);break}},e.prototype.bTitTest=function(t,e,i,o){void 0===i&&(i=[]);var a=e.y,s=t.y-this.widthPoint/2,n=s+2*this.widthPoint+this.widthPoint,r=e.name,h=e.type;if(a>=s)if(n>a)if(GameData.type===h)a>=n-1.2*this.widthPoint&&a<n-.8*this.widthPoint?this.hitFun(r,h,o,30,1):a>=n-1.6*this.widthPoint&&a<n-1.2*this.widthPoint||a>=n-.8*this.widthPoint&&a<n-.4*this.widthPoint?this.hitFun(r,h,o,30,1):a>=n-2*this.widthPoint&&a<n-1.6*this.widthPoint||a>=n-.4*this.widthPoint&&a<n+.2*this.widthPoint?this.hitFun(r,h,o,30,2):this.hitFun(r,h,o,30,2);else{var l=GameData.type;this.accHitFun(l)}else this.streakWin=0},e.prototype.missFun=function(t,e,i){var o=JSON.stringify({event:Const.MISS_FUN_EVENT,name:t,type:e,index:i}),a=MvsManager.getInstance().sendFrameEvent(o);0===a||console.error("sendFrameEvent MISS_FUN_EVENT error",a)},e.prototype.accHitFun=function(t){var e=JSON.stringify({event:Const.ACC_HIT_FUN_EVENT,type:t}),i=MvsManager.getInstance().sendFrameEvent(e);0===i||console.error("sendFrameEvent accHitFun error",i)},e.prototype.hitFun=function(t,e,i,o,a){var s=JSON.stringify({event:Const.HIT_FUN_EVENT,name:t,type:e,index:i,score:o,rank:a}),n=MvsManager.getInstance().sendFrameEvent(s);0===n||console.error("sendFrameEvent HIT_FUN_EVEN error",n)},e.prototype.missOver=function(t){for(var i,o=t.name,a=t.type,s=t.index,n=e.allArr[s],r=0,h=n.length;h>r;r++)if(n[r].name==o){i=n[r];break}if(i.guo!==!0){if(GameData.type===a){this.streakWin=0;var l=a===GameData.players[0].type?GameData.players[0].isDie:GameData.players[1].isDie;l||(SoundUtils.instance().playMiss(),SoundUtils.instance().playBeHit())}i.guo=!0,this.changeBlood({type:i.type},Const.DROP_ACTION)}},e.prototype.changeBlood=function(t,e){if(e===Const.DROP_ACTION){var i=t.type;this.dropBlood(i)}else if(e===Const.RELIVE_ACTION){var i=t.type;this.relive(i)}},e.prototype.dropBlood=function(t){var e=this;if("r"===t&&GameData.players[0].blood>0){if(GameData.type===t&&(this.shanBoo=!0,this.shan.visible=!0,this.shan.alpha=1,egret.Tween.get(this.shan).to({alpha:0,visible:!1},300).call(function(){this.shanBoo=!1},this)),GameData.players[0].blood--,this.blodBar1.scaleBlodX(),GameData.players[0].blood<=0&&(GameData.players[0].blood=0,GameData.players[0].isDie=!0,GameData.type===t)){this.reliveTime++;var i=Math.pow(10,this.reliveTime),o=void 0;o=GameData.gold<i?"金币不足":"复活"+i+"金币",this.reliveBtn.setValue(o);for(var a=0;4>a;a++)1===this.btnClickArr[a]&&this.btnArr[a].goPlay(0);this.showReliveBtnView()}}else if("b"===t&&GameData.players[1].blood>0&&(GameData.type===t&&(this.shanBoo=!0,this.shan.visible=!0,this.shan.alpha=1,egret.Tween.get(this.shan).to({alpha:0,visible:!1},300).call(function(){this.shanBoo=!1},this)),GameData.players[1].blood--,this.blodBar2.scaleBlodX(),GameData.players[1].blood<=0))if(GameData.players[1].blood=0,GameData.players[1].isDie=!0,GameData.isAddRobot)setTimeout(function(){e.relive("b")},5e3);else if(GameData.type===t){this.reliveTime++;var i=Math.pow(10,this.reliveTime),o=void 0;o=GameData.gold<i?"金币不足":"复活"+i+"金币",this.reliveBtn.setValue(o);for(var a=0;4>a;a++)1===this.btnClickArr[a]&&this.btnArr[a].goPlay(0);this.showReliveBtnView()}},e.prototype.showReliveBtnView=function(){this.reliveBtn.visible=!0},e.prototype.hideReliveBtnView=function(){this.reliveBtn.visible=!1},e.prototype.relive=function(t){"r"===t&&0===GameData.players[0].blood?(GameData.players[0].blood=5,GameData.players[0].isDie=!1,this.blodBar1.scaleBlodX()):"b"===t&&0===GameData.players[1].blood&&(GameData.players[1].blood=5,GameData.players[1].isDie=!1,this.blodBar2.scaleBlodX())},e.prototype.accHitOver=function(t){var e=t.type;if(GameData.type===e){this.streakWin=0;var i=e===GameData.players[0].type?GameData.players[0].isDie:GameData.players[1].isDie;i||SoundUtils.instance().playBeHit()}this.changeBlood(t,Const.DROP_ACTION)},e.prototype.hitOver=function(t){for(var i,o=t.name,a=t.type,s=t.index,n=t.rank,r=Number(t.score),h=e.allArr[s],l=0,m=h.length;m>l;l++)if(h[l].name==o){i=h[l];break}i.die||(i.gotoDie(),i.stopMove=!0,i.die=!0,GameData.type===a&&(GameData.langNum++,this.streakWin++,SoundUtils.instance().playHit(),1===n?this.popProm("pop1"):2===n&&this.popProm("pop2")),"r"===i.type?(GameData.players[0].score+=r,this.score1.setValue(GameData.players[0].score+"")):"b"===i.type&&(GameData.players[1].score+=r,this.score2.setValue(GameData.players[1].score+"")))},e.prototype.onEnd=function(t){if(t.preventDefault(),!("r"===GameData.type&&GameData.players[0].isDie===!0||"b"===GameData.type&&GameData.players[1].isDie===!0)){var e=t.currentTarget.name;this.btnClickArr[e]=0,t.currentTarget.goPlay(0)}},e.prototype.fire=function(t){for(var e=this.bombArr.length,i=0;e>i;i++)if(0==this.bombArr[i].visible){this.isFire=!0,"r"===GameData.type?this.bombArr[i].x=Const.SCENT_WIDTH/2-60:"b"===GameData.type&&(this.bombArr[i].x=Const.SCENT_WIDTH/2+60),this.bombArr[i].y=750,this.bombArr[i].lastX=t.x+this.widthPoint,this.bombArr[i].lastY=t.y+this.widthPoint,this.bombArr[i].move(),this.bombArr[i].visible=!0;break}},e.prototype.onFrameHandler=function(t){if(GameData.isGameStart){if(GameData.isGameStart&&GameData.isGameOver)return SoundUtils.instance().stopBg(),void this.shouldGameOver();0==this.streakWin?this.streakWinNum.visible=!1:(this.streakWinNum.visible=!0,this.streakWinNum.setValue(this.streakWin)),this.bg.updata(),this.timeBoo++,this.timeBoo>=GameData.createEnemyTime&&(this.timeBoo=0,this.willInitEnemy()),GameData.isAddRobot===!0&&(this.timeBooRobot++,this.timeBooRobot>=GameData.createEnemyTime&&(this.timeBooRobot=0,this.willInitEnemyByRobot()))}},e.prototype.dispose=function(){egret.Ticker.getInstance().unregister(this.onFrameHandler,this),egret.Tween.removeAllTweens()},e.prototype.onReliveBtnHandler=function(){var t=Math.pow(10,this.reliveTime);GameData.gold>=t?(GameData.gold-=t,this.goldView.setValue(GameData.gold+""),this.hideReliveBtnView(),this.reliveFun(GameData.type)):(console.error("金币不够了"),console.error("GameData.gold",GameData.gold))},e.prototype.reliveFun=function(t){var e=JSON.stringify({event:Const.RELIVE_EVENT,type:t}),i=MvsManager.getInstance().sendFrameEvent(e);0===i||console.error("sendFrameEvent reliveFun error",i)},e.prototype.shouldGameOver=function(){SoundUtils.instance().stopBg(),this.mvsUnBind(),GameSceneView._gameScene.over(),this.dispose()},e.allArr=[],e}(egret.Sprite);__reflect(GameFightView.prototype,"GameFightView");var BackGroundView=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){var t,e=new Hinder,i=new Hinder;t=ResourceUtils.createBitmapByName("fight1BgImage"),this.addChild(t),e.initView(1,1),i.initView(1,2),this.addChild(i),this.addChild(e),i.x=Const.SCENT_WIDTH-i.width},e}(egret.Sprite);__reflect(BackGroundView.prototype,"BackGroundView");var BgView=function(t){function e(){var e=t.call(this)||this;return e.bg1Height=0,e.bg2Height=0,e}return __extends(e,t),e.prototype.initView=function(){this.bg2=new BackGroundView,this.addChild(this.bg2),this.bg1=new BackGroundView,this.addChild(this.bg1),this.bg1Height=this.bg1.height,this.bg1.y=-this.bg1Height+Const.SCENT_HEIGHT,this.bg2Height=this.bg2.height,this.bg2.y=this.bg1.y-this.bg2Height},e.prototype.updata=function(){this.bg1.y>=Const.SCENT_HEIGHT&&(this.bg1.y=this.bg2.y-this.bg1Height),this.bg2.y>=Const.SCENT_HEIGHT&&(this.bg2.y=this.bg1.y-this.bg2Height),this.bg1.y+=GameData.bgSpeed,this.bg2.y+=GameData.bgSpeed},e.prototype.dispose=function(){this.removeChildren(),this.bg1=null,this.bg2=null},e}(egret.Sprite);__reflect(BgView.prototype,"BgView");var BlodBar=function(t){function e(e){var i=t.call(this)||this;return i.w=0,i.type=e,i.initView(e),i}return __extends(e,t),e.prototype.initView=function(t){var e,i;"r"===t?(e=ResourceUtils.createBitmapByName("rBlodBarBgImage"),i=ResourceUtils.createBitmapByName("rBlodBarImage")):"b"===t&&(e=ResourceUtils.createBitmapByName("bBlodBarBgImage"),i=ResourceUtils.createBitmapByName("bBlodBarImage")),this.addChild(e),this.addChild(i),this.blodBar=i,i.x=32,i.y=7,this.w=i.width,this.r=new egret.Rectangle,this.r.x=0,this.r.y=0,this.r.width=i.width,this.r.height=i.height,i.mask=this.r},e.prototype.scaleBlodX=function(){var t="r"===this.type?GameData.players[0].blood:GameData.players[1].blood;this.r.x=-(this.w-this.w*(t/5)),this.blodBar.mask=this.r},e}(egret.Sprite);__reflect(BlodBar.prototype,"BlodBar");var Bomb=function(t){function e(){var e=t.call(this)||this;return e.speed=0,e.angle=0,e.lastX=0,e.lastY=0,e.sp=ResourceUtils.createBitmapByName("bombImage"),e.addChild(e.sp),e.sp.x=e.sp.width/2,e.sp.rotation=90,e.speed=30,egret.Ticker.getInstance().register(e.onFrame,e),e}return __extends(e,t),e.prototype.move=function(){this.rotation=180*Math.atan2(this.lastY-this.y,this.lastX-this.x)/Math.PI,this.angle=this.rotation},e.prototype.onFrame=function(){if(this.visible){this.x+=this.speed*Math.cos(this.angle/180*Math.PI),this.y+=this.speed*Math.sin(this.angle/180*Math.PI);var t=Math.sqrt(Math.pow(this.x-this.lastX,2)+Math.pow(this.y-this.lastY,2));15>t&&(this.visible=!1)}},e.prototype.dispose=function(){egret.Ticker.getInstance().unregister(this.onFrame,this),this.removeChildren(),this.sp=null},e}(egret.Sprite);__reflect(Bomb.prototype,"Bomb");var Enemy=function(t){function e(e){var i=t.call(this)||this;return i.row=0,i.name="",i.over=!1,i.guo=!1,i.die=!1,i.stopMove=!1,i.initView(e),i}return __extends(e,t),e.prototype.initView=function(t){"r"===t?this.sp=StarlingSwfFactory.getInstance().makeMc("honglang"):"b"===t&&(this.sp=StarlingSwfFactory.getInstance().makeMc("lanlang")),this.sp.goToPlay("run"),this.addChild(this.sp)},e.prototype.goToStop=function(){this.sp.gotoAndStop(0)},e.prototype.gotoDie=function(){this.sp.goToPlay("die")},e.prototype.move=function(){if(this.stopMove)this.goOut();else if(this.y<1e3){var t=this.y+GameData.enemySpeed;egret.Tween.get(this).to({y:t},100)}else this.y=1e3,this.over=!0},e.prototype.goOut=function(){0===this.row?(this.x-=15,this.y-=15):1===this.row?(this.x-=15,this.y-=20):2===this.row?(this.x+=15,this.y-=20):3===this.row&&(this.x+=15,this.y-=15)},e.prototype.dispose=function(){this.removeChildren()},e}(egret.Sprite);__reflect(Enemy.prototype,"Enemy");var FightButton=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this.button=StarlingSwfFactory.getInstance().makeMc("bazi"),this.addChild(this.button),this.button.gotoAndStop(0)
},e.prototype.goPlay=function(t){this.button.gotoAndStop(t)},e}(egret.Sprite);__reflect(FightButton.prototype,"FightButton");var GoldView=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){var t=ResourceUtils.createBitmapByName("goldBg"),e=ResourceUtils.createBitmapByName("gold");e.x=10,e.y=t.height/2-e.height/2,this.addChild(t),this.addChild(e),this.goldValue=new egret.TextField,this.goldValue.size=24,this.goldValue.textColor=16698168,this.goldValue.text="0",this.goldValue.width=120,this.goldValue.height=32,this.goldValue.x=20,this.goldValue.textAlign="center",this.goldValue.verticalAlign="middle",this.addChild(this.goldValue)},e.prototype.setValue=function(t){this.goldValue.text=t},e}(egret.Sprite);__reflect(GoldView.prototype,"GoldView");var Hinder=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(t,e){var i;switch(t){case 1:1==e?(i=ResourceUtils.createBitmapByName("wall1_1Image"),this.addChild(i)):(i=ResourceUtils.createBitmapByName("wall1_2Image"),this.addChild(i))}},e}(egret.Sprite);__reflect(Hinder.prototype,"Hinder");var JoinRoomView=function(t){function e(e,i){var o=t.call(this)||this;return o.patt=/[^0-9]/,o.dMask=e,o.gameEnterView=i,o.initView(),o}return __extends(e,t),e.prototype.initView=function(){var t=this;this.bg=ResourceUtils.createBitmapByName("profileBg_png"),this.addChild(this.bg),this.closeBtn=new MyButtonForGame("btn_close_png","btn_close_png"),this.addChild(this.closeBtn),this.closeBtn.x=this.bg.width-this.closeBtn.width/2,this.closeBtn.y=-this.closeBtn.height/2,this.closeBtn.setClick(this.closeBtnHandler.bind(this));var e=new egret.TextField;e.text="输入房间ID",e.textColor=3355443,e.fontFamily="Microsoft YaHei UI",e.size=18,e.x=this.bg.width/2-e.width/2,e.y=46,this.addChild(e);var i=ResourceUtils.createBitmapByName("inputBg_png");i.width=360,i.height=48,i.x=this.bg.width/2-i.width/2,i.y=89,this.addChild(i),this.roomId="",this.roomIdInput=new egret.TextField,this.roomIdInput.type=egret.TextFieldType.INPUT,this.roomIdInput.size=18,this.roomIdInput.textColor=0,this.roomIdInput.fontFamily="Microsoft YaHei UI",this.roomIdInput.width=i.width-30,this.roomIdInput.height=i.height,this.roomIdInput.x=i.x+15,this.roomIdInput.y=i.y+i.height/2-this.roomIdInput.height/2,this.roomIdInput.verticalAlign="middle",this.roomIdInput.addEventListener(egret.Event.CHANGE,function(){t.roomId=t.roomIdInput.text},this),this.addChild(this.roomIdInput);var o=new MyButtonForGame("btn_joinRoom2_png","btn_joinRoom2_png");o.x=this.bg.width/2-o.width/2,o.y=165,this.addChild(o),o.setClick(this.joinRoom.bind(this))},e.prototype.closeBtnHandler=function(){GameData.isServerErrorCode1000||(GameData.isJoinRoomBtn1Click=!1,GameData.isJoinRoomBtn2Click=!1,this.hideJoinRoomView())},e.prototype.hideJoinRoomView=function(){this.dMask.visible===!0&&this.visible===!0&&(this.dMask.visible=!1,this.visible=!1,GameData.isShowJoinRoomView=!1)},e.prototype.joinRoom=function(){return GameData.isServerErrorCode1000||GameData.isQuickJoinBtnClick===!0||GameData.isCreateRoomBtnClick===!0||GameData.isRoomItemClick===!0?void 0:this.patt.test(this.roomId)||""===this.roomId?void this.gameEnterView.showPrompt("请输入正确的房间号"):void(GameData.isJoinRoomBtn2Click!==!0&&(GameData.isJoinRoomBtn2Click=!0,this.gameEnterView.joinRoom(this.roomId),this.roomIdInput.text="",this.roomId=""))},e}(egret.Sprite);__reflect(JoinRoomView.prototype,"JoinRoomView");var MusicView=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){var t=new egret.Sprite;this.addChild(t);var e=ResourceUtils.createBitmapByName("maskImage");t.addChild(e),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchThis,this),this.spContainer=new egret.Sprite,this.addChild(this.spContainer);var i=Const.SCENT_WIDTH/8,o=Const.SCENT_HEIGHT/4;this.spContainer.x=i,this.spContainer.y=o;var a=ResourceUtils.createBitmapByName("optionMusicBgImage");this.spContainer.addChild(a);var s=new egret.Sprite;this.spContainer.addChild(s);var n=ResourceUtils.createBitmapByName("option7Image");s.addChild(n),s.touchEnabled=!0,s.x=this.spContainer.width-.7*s.width,s.y=.4*-s.height,s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closePop,this);var r=new egret.Sprite;this.spContainer.addChild(r),this.spguanbg=ResourceUtils.createBitmapByName("option5Image"),r.addChild(this.spguanbg),this.spkaibg=ResourceUtils.createBitmapByName("option6Image"),r.addChild(this.spkaibg),this.spguanbg.x=0,this.spkaibg.x=30,r.x=182,r.y=84,r.touchEnabled=!0,r.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBgHandler,this);var h=new egret.Sprite;this.spContainer.addChild(h),this.spguan=ResourceUtils.createBitmapByName("option5Image"),h.addChild(this.spguan),this.spkai=ResourceUtils.createBitmapByName("option6Image"),h.addChild(this.spkai),this.spguan.x=0,this.spkai.x=30,h.x=182,h.y=148,h.touchEnabled=!0,h.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this),GameData.closeBgMusic?(this.spguanbg.visible=!0,this.spkaibg.visible=!1):(this.spguanbg.visible=!1,this.spkaibg.visible=!0),GameData.closeMusic?(this.spguan.visible=!0,this.spkai.visible=!1):(this.spguan.visible=!1,this.spkai.visible=!0)},e.prototype.onTouchThis=function(t){t.stopImmediatePropagation(),t.stopPropagation()},e.prototype.clickHandler=function(t){GameData.closeMusic?(this.spkai.visible=!0,this.spguan.visible=!1,GameData.closeMusic=!1):(this.spkai.visible=!1,this.spguan.visible=!0,GameData.closeMusic=!0)},e.prototype.clickBgHandler=function(t){GameData.closeBgMusic?(this.spguanbg.visible=!1,this.spkaibg.visible=!0,GameData.closeBgMusic=!1):(this.spguanbg.visible=!0,this.spkaibg.visible=!1,GameData.closeBgMusic=!0)},e.prototype.closePop=function(t){this.parent&&(GameData.isClickBtn=!1),this.visible=!1},e.prototype.removeAll=function(){this.removeChildren()},e}(egret.Sprite);__reflect(MusicView.prototype,"MusicView");var MyButton=function(t){function e(e,i){var o=t.call(this)||this;return o.sp=new egret.Sprite,o.addChild(o.sp),o.bg=ResourceUtils.createBitmapByName(e),o.sp.addChild(o.bg),o.title=ResourceUtils.createBitmapByName(i),null==o.title.texture&&(o.title.texture=RES.getRes(i)),o.title.x=o.bg.width-o.title.width>>1,o.title.y=o.bg.height-o.title.height>>1,o.sp.addChild(o.title),o.noScaleX=o.sp.x,o.noScaleY=o.sp.y,o}return __extends(e,t),e.prototype.setClick=function(t){this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickEvent,this),this.onClick=t},e.prototype.onClickEvent=function(){var t=(this.sp.width-.8*this.sp.width)/2,e=(this.sp.height-.8*this.sp.height)/2;this.tw=egret.Tween.get(this.sp),this.tw.to({scaleX:.7,scaleY:.7,x:t,y:e},40).to({scaleX:1,scaleY:1,x:this.noScaleX,y:this.noScaleY},40),this.onClick()},e}(egret.Sprite);__reflect(MyButton.prototype,"MyButton");var AlertPanel=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){console.log("initView"),this.initBG(),this.initBtn(),this.initTf(),this.anchorOffsetX=.5*this.width,this.anchorOffsetY=.5*this.height,this.x=Const.SCENT_WIDTH/2,this.y=Const.SCENT_HEIGHT/2},e.prototype.initBG=function(){this._panelBg=new egret.Shape,this._panelBg.graphics.lineStyle(1,6710886,1),this._panelBg.graphics.beginFill(16777215,.9),this._panelBg.graphics.drawRect(0,0,300,200),this._panelBg.graphics.endFill(),this._panelBg.width=300,this._panelBg.height=200,this.addChild(this._panelBg)},e.prototype.initBtn=function(){this._btn=new egret.Shape,this._btn.graphics.lineStyle(1,6710886,1),this._btn.graphics.beginFill(16777215),this._btn.graphics.drawRect(0,0,80,40),this._btn.graphics.endFill(),this._btn.width=80,this._btn.height=40,this._btn.x=110,this._btn.y=140,this._btn.touchEnabled=!0,this._btn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onClickBtn,this),this.addChild(this._btn),this._btnLabel=new egret.TextField,this._btnLabel.size=20,this._btnLabel.textColor=3355443,this._btnLabel.text="确定",this._btnLabel.width=80,this._btnLabel.height=40,this._btnLabel.bold=!0,this._btnLabel.x=this._btn.x,this._btnLabel.y=this._btn.y,this._btnLabel.textAlign="center",this._btnLabel.verticalAlign="middle",this.addChild(this._btnLabel)},e.prototype.initTf=function(){this._msgTf=new egret.TextField,this._msgTf.textAlign="center",this._msgTf.verticalAlign="middle",this._msgTf.width=240,this._msgTf.height=100,this._msgTf.x=30,this._msgTf.y=20,this._msgTf.textColor=5592405,this._msgTf.size=25,this._msgTf.bold=!0,this.addChild(this._msgTf)},e.i=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.showErr=function(t){this._msgTf.text=t,egret.MainContext.instance.stage.addChild(this)},e.prototype.onClickBtn=function(){egret.RuntimeType.WEB==egret.Capabilities.runtimeType?this.reloadPage():this.hide()},e.prototype.reloadPage=function(){location.reload()},e.prototype.hide=function(){this.parent&&this.parent.removeChild(this)},e}(egret.DisplayObjectContainer);__reflect(AlertPanel.prototype,"AlertPanel");var OptionView=function(t){function e(e,i){var o=t.call(this)||this;return i&&(o.gamePlayView=i),o.initView(e),o}return __extends(e,t),e.prototype.initView=function(t){var e=new egret.Sprite;this.addChild(e);var i=ResourceUtils.createBitmapByName("maskImage");e.addChild(i),e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),this.spContainer=new egret.Sprite,this.addChild(this.spContainer);var o;t===Const.IN_START_VIEW?o=ResourceUtils.createBitmapByName("optionMusicBgImage"):t===Const.IN_PLAY_VIEW&&(o=ResourceUtils.createBitmapByName("optionBgImage")),this.spContainer.addChild(o);var a=Const.SCENT_WIDTH/8,s=Const.SCENT_HEIGHT/4;if(this.spContainer.x=a,this.spContainer.y=s,t===Const.IN_PLAY_VIEW){var n=new egret.Sprite;this.spContainer.addChild(n);var r=ResourceUtils.createBitmapByName("btn_leaveRoom_png");n.addChild(r),n.x=this.spContainer.width/2-n.width/2,n.y=210,n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leaveRoom,this),n.touchEnabled=!0}var h=new egret.Sprite;this.spContainer.addChild(h);var l=ResourceUtils.createBitmapByName("option7Image");h.addChild(l),h.touchEnabled=!0,h.x=this.spContainer.width-.7*h.width,h.y=.4*-h.height,h.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closePop,this);var m=new egret.Sprite;this.spContainer.addChild(m),this.spguanbg=ResourceUtils.createBitmapByName("option5Image"),m.addChild(this.spguanbg),this.spkaibg=ResourceUtils.createBitmapByName("option6Image"),m.addChild(this.spkaibg),this.spguanbg.x=0,this.spkaibg.x=30,m.x=182,m.y=84,m.touchEnabled=!0,m.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBgHandler,this);var p=new egret.Sprite;this.spContainer.addChild(p),this.spguan=ResourceUtils.createBitmapByName("option5Image"),p.addChild(this.spguan),this.spkai=ResourceUtils.createBitmapByName("option6Image"),p.addChild(this.spkai),this.spguan.x=0,this.spkai.x=30,p.x=182,p.y=148,p.touchEnabled=!0,p.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this),GameData.closeBgMusic?(this.spguanbg.visible=!0,this.spkaibg.visible=!1):(this.spguanbg.visible=!1,this.spkaibg.visible=!0),GameData.closeMusic?(this.spguan.visible=!0,this.spkai.visible=!1):(this.spguan.visible=!1,this.spkai.visible=!0)},e.prototype.onClickHandler=function(t){t.stopPropagation(),t.stopImmediatePropagation()},e.prototype.clickHandler=function(t){GameData.closeMusic?(this.spkai.visible=!0,this.spguan.visible=!1,GameData.closeMusic=!1):(this.spkai.visible=!1,this.spguan.visible=!0,GameData.closeMusic=!0)},e.prototype.clickBgHandler=function(t){GameData.closeBgMusic?(this.spguanbg.visible=!1,this.spkaibg.visible=!0,GameData.closeBgMusic=!1,SoundUtils.instance().playBg()):(this.spguanbg.visible=!0,this.spkaibg.visible=!1,GameData.closeBgMusic=!0,SoundUtils.instance().stopBg())},e.prototype.closePop=function(t){this.visible=!1},e.prototype.leaveRoom=function(){this.gamePlayView&&this.gamePlayView.leaveRoom()},e}(egret.Sprite);__reflect(OptionView.prototype,"OptionView");var Const=function(){function t(){}return t.SCENT_WIDTH=0,t.SCENT_HEIGHT=0,t.GamePoxY=0,t.setSwfArr=["s","t","a","t","i","c",".","e","g","r","e","t","-","l","a","b","s",".","o","r","g"],t.gameId=201126,t.appKey="f38ef43d2c024590afd295cc311440dd",t.secretKey="9ae1acc200bd4a178d0be24bf3b1f5a3",t.gameVersion=1,t.channel="Matchvs",t.platform="alpha",t.deviceId="123456789",t.gatewayId=0,t.token="",t.userId=0,t.userName="",t.avatarUrl="",t.WILL_INIT_ENEMY_EVENT="will_init_enemy_event",t.MISS_FUN_EVENT="miss_fun_event",t.ACC_HIT_FUN_EVENT="acc_hit_fun_event",t.HIT_FUN_EVENT="hit_fun_event",t.GAME_WILL_PLAY_EVENT="game_will_play_event",t.RELIVE_EVENT="relive_event",t.ADD_ACTION="add_action",t.DROP_ACTION="drop_action",t.RELIVE_ACTION="relive_action",t.IN_START_VIEW="in_start_view",t.IN_PLAY_VIEW="in_play_view",t}();__reflect(Const.prototype,"Const");var Prompt=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this.bg=ResourceUtils.createBitmapByName("bg_list_png"),this.bg.height/=2,this.addChild(this.bg),this.txt=new egret.TextField,this.txt.text="我是一个测试",this.txt.textColor=16711680,this.txt.fontFamily="Microsoft YaHei UI",this.txt.bold=!0,this.txt.size=20,this.txt.x=this.bg.width/2-this.txt.width/2,this.txt.y=this.bg.height/2-this.txt.height/2,this.addChild(this.txt)},e.prototype.setValue=function(t){this.txt.text=t,this.txt.x=this.bg.width/2-this.txt.width/2},e}(egret.Sprite);__reflect(Prompt.prototype,"Prompt");var PromptPop=function(t){function e(){var e=t.call(this)||this;return e.isShow=!1,e.isInto=!1,e.isAway=!1,e.isHide=!1,e.stay=0,e.tX=0,e.tY=0,e.config={isHide:!0,stayTime:800,tx:0,ty:0},e}return __extends(e,t),e.prototype.activate=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),this.config.tx=t,this.config.ty=e,this.settings(i),this.targetMc=StarlingSwfFactory.getInstance().makeMc("tip"),this.addChild(this.targetMc),this.targetMc.x=this.tX,this.targetMc.y=this.tY,this.targetMc.visible=!1},e.prototype.show=function(t,e){void 0===e&&(e=null),null!=this.targetMc&&(e&&(null!=e.isHide&&(this.isHide=e.isHide),null!=e.stayTime&&(this.stay=e.stayTime),null!=e.tx&&(this.tX=e.tx),null!=e.ty&&(this.tY=e.ty)),this.setMc(t),this.tweenStar())},e.prototype.tweenStar=function(){this.isInto=!0,this.isShow=!0,this.isAway=!1,this.targetMc.x=this.tX,this.targetMc.y=this.tY,this.targetMc.alpha=1,this.targetMc.visible=!0,this.tw=egret.Tween.get(this.targetMc).call(this.tweenStop,this),this.tw.to({y:this.tY-200,alpha:1},200)},e.prototype.tweenStop=function(){this.isInto=!1,this.isHide&&(this.isAway=!0,this.tw=egret.Tween.get(this.targetMc).call(this.tweenOver,this),this.tw.to({alpha:0,delay:1,visible:!1},this.stay)),this.settings()},e.prototype.tweenOver=function(){this.isShow=!1,this.isAway=!1},e.prototype.hide=function(t){void 0===t&&(t=0),this.isHide=!0,this.stay=t,this.tweenStop()},e.prototype.settings=function(t){if(void 0===t&&(t=null),null!=t)for(var e in this.config)this.config[e]=null!=t[e]?t[e]:this.config[e];this.isHide=this.config.isHide,this.stay=this.config.stayTime,this.tX=this.config.tx,this.tY=this.config.ty},e.prototype.setMc=function(t){this.targetMc.goToPlay(t)},Object.defineProperty(e.prototype,"isSHOW",{get:function(){return this.isShow},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isINTO",{get:function(){return this.isInto},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAWAY",{get:function(){return this.isAway},enumerable:!0,configurable:!0}),e.prototype.removeAll=function(){},e}(egret.Sprite);__reflect(PromptPop.prototype,"PromptPop");var RandomMatchView=function(t){function e(e,i){var o=t.call(this)||this;return o.dMask=e,o.gameEnterView=i,o.initView(),o}return __extends(e,t),e.prototype.initView=function(){this.bg=ResourceUtils.createBitmapByName("profileBg_png"),this.bg.width/=2,this.bg.height/=3,this.addChild(this.bg);var t=new egret.TextField;t.text="正在随机匹配",t.size=20,t.textColor=3355443,t.fontFamily="Microsoft YaHei UI",t.x=this.bg.width/2-t.width/2,t.y=30,this.addChild(t),this.waitTime=new SpecialNumber("number-"),this.addChild(this.waitTime),this.waitTime.setValue("0"),this.waitTime.x=this.bg.width/2-this.waitTime.width/2,this.waitTime.y=65,this.backBtn=new MyButtonForGame("btn_back_png","btn_back_png"),this.backBtn.x=this.bg.width/2-this.backBtn.width/2,this.backBtn.y=100,this.addChild(this.backBtn),this.backBtn.setClick(this.backBtnClickHandler.bind(this))},e.prototype.tickTop=function(){var t=this,e=1;this.timer=setInterval(function(){return GameData.isServerErrorCode1000?void clearInterval(t.timer):(t.waitTime.setValue(e+""),t.waitTime.x=t.bg.width/2-t.waitTime.width/2,void e++)},1e3)},e.prototype.closeTickTop=function(){GameData.isServerErrorCode1000||(clearInterval(this.timer),this.waitTime.setValue("0"))},e.prototype.backBtnClickHandler=function(){GameData.isLeaveRoomBtn2Click||(GameData.isLeaveRoomBtn2Click=!0,this.gameEnterView.leaveRoom())},e}(egret.Sprite);__reflect(RandomMatchView.prototype,"RandomMatchView");var RedGirl=function(t){function e(e){var i=t.call(this)||this;return i.initView(e),i}return __extends(e,t),e.prototype.initView=function(t){"r"===t?this.girl=StarlingSwfFactory.getInstance().makeMc("xiaohongmao"):"b"===t&&(this.girl=StarlingSwfFactory.getInstance().makeMc("xiaolanmao")),this.addChild(this.girl),this.girl.gotoAndStop(0)},e.prototype.run=function(){this.girl.goToPlay("1")},e.prototype.gotoDie=function(){this.girl.goToPlay("2")},e.prototype.gotoWin=function(){this.girl.goToPlay("3")},e.prototype.dispose=function(){this.removeChildren()},e}(egret.Sprite);__reflect(RedGirl.prototype,"RedGirl");var ReliveBtn=function(t){function e(){var e=t.call(this,"btn_relive_png","btn_relive_png")||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this.label=new egret.TextField,this.addChild(this.label),this.label.text="复活10金币",this.label.size=25,this.label.textColor=16777215,this.label.fontFamily="Microsoft YaHei UI",this.label.textAlign=egret.HorizontalAlign.CENTER,this.label.verticalAlign=egret.VerticalAlign.MIDDLE,this.label.strokeColor=9589278,this.label.stroke=2,this.label.x=this.width/2-this.label.width/2,this.label.y=this.height/2-this.label.height/2-5},e.prototype.setValue=function(t){this.label.text=t+"",this.label.x=this.width/2-this.label.width/2},e}(MyButtonForGame);__reflect(ReliveBtn.prototype,"ReliveBtn");var ResourceUtils=function(){function t(){}return t.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},t.createBitmapFromSheet=function(t,e){void 0===e&&(e="gameRes");var i=RES.getRes(e),o=i.getTexture(t),a=new egret.Bitmap;return a.texture=o,a},t.getTextureFromSheet=function(t,e){void 0===e&&(e="gameRes");var i=RES.getRes(e),o=i.getTexture(t);return o},t}();__reflect(ResourceUtils.prototype,"ResourceUtils");var RoomList=function(t){function e(e){var i=t.call(this)||this;return i.gameEnterView=e,i.initView(),i}return __extends(e,t),e.prototype.initView=function(){this.content=new egret.Sprite;var t=new egret.ScrollView;t.horizontalScrollPolicy="off",t.verticalScrollPolicy="on",t.setContent(this.content),t.width=Const.SCENT_WIDTH,t.height=450,this.addChild(t)},e.prototype.freshRoomItem=function(t){this.removeRoomItem();for(var e=0,i=t.length;i>e;e++){var o=ResourceUtils.createBitmapByName("bg_list_png"),a=new egret.Sprite;a.touchEnabled=!0,a.x=Const.SCENT_WIDTH/2-o.width/2,a.y=110*e,a.name=t[e].roomID,a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.roomItemClickHandler,this),a.addChild(o),this.content.addChild(a);var s=new egret.TextField;s.size=18,s.textColor=16777215,s.text=t[e].roomID+"",s.x=22,s.y=o.height/2-s.height/2,a.addChild(s)}},e.prototype.roomItemClickHandler=function(t){GameData.isServerErrorCode1000||GameData.isQuickJoinBtnClick!==!0&&GameData.isCreateRoomBtnClick!==!0&&GameData.isJoinRoomBtn2Click!==!0&&GameData.isRoomItemClick!==!0&&(GameData.isRoomItemClick=!0,this.roomId=t.currentTarget.name,this.roomId!==GameData.lastRoomId&&this.joinRoom())},e.prototype.joinRoom=function(){this.gameEnterView.joinRoom(this.roomId)},e.prototype.removeRoomItem=function(){this.content.removeChildren()},e}(egret.DisplayObjectContainer);__reflect(RoomList.prototype,"RoomList");var RoomView=function(t){function e(e){var i=t.call(this)||this;return i.gameEnterView=e,i.initView(),i}return __extends(e,t),e.prototype.initView=function(){this.width=Const.SCENT_WIDTH,this.height=Const.SCENT_HEIGHT-130,this.roomIdTxt=new egret.TextField,this.roomIdTxt.text="房间ID: 0",this.roomIdTxt.x=this.width/2-this.roomIdTxt.width/2,this.roomIdTxt.y=2,this.roomIdTxt.textColor=8999211,this.roomIdTxt.fontFamily="Microsoft YaHei UI",this.roomIdTxt.size=19,this.addChild(this.roomIdTxt),this.roomItem1Sp=new egret.Sprite,this.addChild(this.roomItem1Sp);var t=ResourceUtils.createBitmapByName("roomBg_png");t.width=420,t.height=100,t.x=this.width/2-t.width/2,t.y=this.roomIdTxt.y+this.roomIdTxt.height+20,this.roomItem1Sp.addChild(t),this.userName1Txt=new egret.TextField,this.userName1Txt.text="--",this.userName1Txt.size=20,this.userName1Txt.textColor=16777215,this.userName1Txt.x=t.x+25,this.userName1TxtBaseHeight=t.y+t.height/2,this.userName1Txt.y=this.userName1TxtBaseHeight-this.userName1Txt.height/2,this.roomItem1Sp.addChild(this.userName1Txt);var e=new egret.TextField;e.text="房主",e.size=20,e.textColor=2806335,e.fontFamily="Microsoft YaHei UI",e.bold=!0,e.x=t.x+t.width-60-e.width/2,e.y=t.y+t.height/2-e.height/2,this.roomItem1Sp.addChild(e),this.roomItem2Sp=new egret.Sprite,this.addChild(this.roomItem2Sp);var i=ResourceUtils.createBitmapByName("roomBg_png");i.width=t.width,i.height=t.height,i.x=t.x,i.y=t.y+t.height+10,this.roomItem2Sp.addChild(i),this.userName2Txt=new egret.TextField,this.userName2Txt.text="--",this.userName2Txt.size=20,this.userName2Txt.textColor=16777215,this.userName2Txt.x=this.userName1Txt.x,this.userName2TxtBaseHeight=i.y+i.height/2,this.userName2Txt.y=this.userName2TxtBaseHeight-this.userName2Txt.height/2,this.roomItem2Sp.addChild(this.userName2Txt),this.kickPlayerBtn=new MyButtonForGame("btn_kickPlayer_png","btn_kickPlayer_png"),this.kickPlayerBtn.x=i.x+i.width-60-this.kickPlayerBtn.width/2,this.kickPlayerBtn.y=i.y+i.height/2-this.kickPlayerBtn.height/2,this.roomItem2Sp.addChild(this.kickPlayerBtn),this.kickPlayerBtn.setClick(this.kickPlayer.bind(this)),this.kickPlayerBtn.visible=!1,this.addRobotBtn=new MyButtonForGame("btn_addRobot_png","btn_addRobot_png"),this.addRobotBtn.x=this.kickPlayerBtn.x-this.addRobotBtn.width+this.kickPlayerBtn.width,this.addRobotBtn.y=this.kickPlayerBtn.y,this.roomItem2Sp.addChild(this.addRobotBtn),this.addRobotBtn.setClick(this.addRobot.bind(this)),this.startGameBtn=new MyButtonForGame("btn_startGame_png","btn_startGame_png"),this.startGameBtn.x=this.width/2-this.startGameBtn.width/2,this.startGameBtn.y=this.height-200-this.startGameBtn.height/2,this.addChild(this.startGameBtn),this.startGameBtn.setClick(this.startGame.bind(this));var o=new MyButtonForGame("btn_leaveRoom_png","btn_leaveRoom_png");o.x=this.width/2-o.width/2,o.y=this.height-60-o.height,this.addChild(o),o.setClick(this.leaveRoom.bind(this))},e.prototype.kickPlayer=function(){if(!GameData.isServerErrorCode1000&&GameData.isOwner!==!1){var t=Number(this.userName2Txt.text);this.gameEnterView.kickPlayer(t)}},e.prototype.setRoomIdTxt=function(t,e){1==t?(this.roomIdTxt.text="房间ID: "+e,this.roomIdTxt.x=this.width/2-this.roomIdTxt.width/2):2==t&&(this.roomIdTxt.text="",this.roomIdTxt.x=this.width/2-this.roomIdTxt.width/2)},e.prototype.setUserName=function(t,e){1==t?(this.userName1Txt.text=e,this.userName1Txt.y=this.userName1TxtBaseHeight-this.userName1Txt.height/2):2==t?(this.userName2Txt.text=e,this.userName2Txt.y=this.userName2TxtBaseHeight-this.userName2Txt.height/2):3==t&&(this.userName1Txt.text="--",this.userName2Txt.text="--",this.userName1Txt.y=this.userName1TxtBaseHeight-this.userName1Txt.height/2,this.userName2Txt.y=this.userName2TxtBaseHeight-this.userName2Txt.height/2)},e.prototype.leaveRoom=function(){GameData.isServerErrorCode1000||GameData.isLeaveRoomBtnClick||(GameData.isLeaveRoomBtnClick=!0,this.gameEnterView.leaveRoom())},e.prototype.startGame=function(){GameData.isServerErrorCode1000||GameData.joinOverStatus>=2||GameData.setFrameStatus>=2||GameData.isOwner&&(GameData.isAddRobot===!0?2==GameData.players.length&&this.gameEnterView.gameWillPlayWithRobot():2==GameData.players.length&&this.gameEnterView.joinOver())},e.prototype.addRobot=function(){GameData.isServerErrorCode1000||(GameData.isAddRobot=!0,GameData.players[1]={userId:0,userName:"robot",type:"b",score:0,blood:5,isDie:!1},this.setUserName(2,"Hi, i am robot"),this.gameEnterView.joinOver())},e.prototype.showKickPlayerBtn=function(){this.kickPlayerBtn.visible=!0},e.prototype.hideKickPlayerBtn=function(){this.kickPlayerBtn.visible=!1},e.prototype.showAddRobotBtn=function(){this.addRobotBtn.visible=!0},e.prototype.hideAddRobotBtn=function(){this.addRobotBtn.visible=!1},e.prototype.showStartGameBtn=function(){this.startGameBtn.visible=!0},e.prototype.hideStartGameBtn=function(){this.startGameBtn.visible=!1},e}(egret.Sprite);__reflect(RoomView.prototype,"RoomView");var SoundBase=function(t){function e(e){var i=t.call(this)||this;return i._soundURL="bgSound",i._positon=0,i._loop=1,i._status=0,e&&(i._soundURL=e),i._sound=new egret.Sound,i._loadSound(),i}return __extends(e,t),e.prototype._loadSound=function(){RES.getRes(this._soundURL)?this._sound=RES.getRes(this._soundURL):(this._sound.once(egret.Event.COMPLETE,this.loadComplete,this),this._sound.once(egret.IOErrorEvent.IO_ERROR,this.onLoadErr,this),this._sound.load(this._soundURL))},e.prototype.loadComplete=function(t){this._status=3;var e="加载完成";egret.log(e),this._sound.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadErr,this),this.dispatchEventWith(egret.Event.COMPLETE,!1,e)},e.prototype.onLoadErr=function(t){this._status=4;var e="加载失败"+this._soundURL;egret.log(e),this._sound.removeEventListener(egret.Event.COMPLETE,this.loadComplete,this),this.dispatchEventWith(egret.IOErrorEvent.IO_ERROR,!1,e)},e.prototype.setUrl=function(t){this._soundURL=t,this._loadSound()},e.prototype.looped=function(t){console.log("looped"),this._soundChannel=null,this._positon=0,this._status=0;var e="播放完成";this._loop>=0?this.dispatchEventWith(egret.Event.SOUND_COMPLETE,!1,e):this.play()},e.prototype.getStatus=function(){return this._status},e.prototype.setVolume=function(t){console.log(this._status),1===this._status&&(this._soundChannel.volume=t/100)},e.prototype.showPosition=function(){return 1===this._status&&(this._positon=this._soundChannel.position),this._positon},e.prototype.play=function(){return 4===this._status?void this._loadSound():(this._status=1,this._soundChannel&&this._soundChannel.stop(),this._soundChannel=this._sound.play(this._positon,1),this._soundChannel.once(egret.Event.SOUND_COMPLETE,this.looped,this),this._status)},e.prototype.setLoop=function(t){return void 0===t&&(t=1),this._loop=t,t},e.prototype.pause=function(){var t=this._status;return 1===t&&(this._positon=this._soundChannel.position,this._soundChannel.stop(),this._status=2),egret.log(this._positon),t},e.prototype.resume=function(){var t=this._status;return 2===t&&this.play(),egret.log(this._positon),t},e.prototype.stop=function(){this._status=0,this._positon=0,this._soundChannel.stop(),this._soundChannel=null},e}(egret.DisplayObjectContainer);__reflect(SoundBase.prototype,"SoundBase");var SoundUtils=function(){function t(){if(null!=t._instance)throw new Error("singleton")}return t.instance=function(){return null==this._instance?this._instance=new t:this._instance},t.prototype.initSound=function(){this.bgSound=new SoundBase("bgSound"),this.winSound=new SoundBase("winSound"),this.missSound=new SoundBase("missSound"),this.hitSound=new SoundBase("hitSound"),this.goSound=new SoundBase("hitSound"),this.overSound=new SoundBase("overSound"),this.beHitSound=new SoundBase("beHitSound"),this.numSound=new SoundBase("numSound")},t.prototype.playNum=function(){GameData.closeMusic||this.numSound.play()},t.prototype.playBeHit=function(){GameData.closeMusic||this.beHitSound.play()},t.prototype.playOver=function(){GameData.closeMusic||this.overSound.play()},t.prototype.playGo=function(){GameData.closeMusic||this.goSound.play()},t.prototype.playHit=function(){GameData.closeMusic||this.hitSound.play()},t.prototype.playMiss=function(){GameData.closeMusic||this.missSound.play()},t.prototype.playWin=function(){GameData.closeMusic||this.winSound.play()},t.prototype.playBg=function(){return GameData.closeBgMusic?void this.bgSound.pause():(this.bgSound.play(),void this.beHitSound.setLoop(1))},t.prototype.stopBg=function(){this.bgSound.pause()},t}();__reflect(SoundUtils.prototype,"SoundUtils");var SpecialNumber=function(t){function e(e){var i=t.call(this)||this;return i.charName=e,i}return __extends(e,t),e.prototype.setValue=function(t){if(this.removeChildren(),""!=t&&null!=t)for(var e=(t+"").split(""),i=e.length,o=0,a=0;i>a;a++){var s=e[a];if(","==s&&(s="dot"),"/"==s&&(s="gang"),"number-"==this.charName){var n;n="gang"==s?ResourceUtils.createBitmapFromSheet(this.charName+s,"sourceNum"):"dot"==s?ResourceUtils.createBitmapFromSheet(this.charName+s,"sourceNum"):ResourceUtils.createBitmapFromSheet(this.charName+s,"sourceNum")}else if("number-0"==this.charName){var n;n="gang"==s?ResourceUtils.createBitmapFromSheet(this.charName+s,"streakNum"):"dot"==s?ResourceUtils.createBitmapFromSheet(this.charName+s,"streakNum"):ResourceUtils.createBitmapFromSheet(this.charName+s,"streakNum")}n&&(n.x=o,o+=n.width,this.addChild(n))}},e}(egret.Sprite);__reflect(SpecialNumber.prototype,"SpecialNumber");var StreakNum=function(t){function e(){var e=t.call(this)||this;return e.conboW=0,e.initView(),e}return __extends(e,t),e.prototype.initView=function(){var t=ResourceUtils.createBitmapByName("comboImage");this.addChild(t),this.conboW=t.width,this.showSorce=new SpecialNumber("number-0"),this.showSorce.x=this.conboW/2-this.showSorce.width/2,this.showSorce.y=t.height+5,this.addChild(this.showSorce)},e.prototype.setValue=function(t){void 0===t&&(t=0),this.showSorce.x=this.conboW/2-this.showSorce.width/2,this.showSorce.setValue(t+"")},e}(egret.Sprite);__reflect(StreakNum.prototype,"StreakNum");var starlingswf;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.parseSpriteSheet=function(t,e){var i=e.frames;if(i){var o=new egret.SpriteSheet(t);for(var a in i){var s=i[a];o.createTexture(a,s.x,s.y,s.w,s.h,-s.offX,-s.offY)}return o}},e}(RES.SheetAnalyzer);t.StarlingSwfSheetAnalyzer=e,__reflect(e.prototype,"starlingswf.StarlingSwfSheetAnalyzer")}(starlingswf||(starlingswf={}));var starlingswf;!function(t){var e=function(){function e(i,o,a){void 0===a&&(a=24),this._swfData=i,this._assetManager=o,this._createDisplayFuns=new Object,this._createDisplayFuns[e.dataKey_Sprite]=this.createSprite,this._createDisplayFuns[e.dataKey_MovieClip]=this.createMovie,this._createDisplayFuns[e.dataKey_Image]=this.createImage,this._createDisplayFuns[e.dataKey_Scale9]=this.createS9Image,this._createDisplayFuns[e.dataKey_ShapeImg]=this.createShapeImage,this._createDisplayFuns[e.dataKey_TextField]=this.createTextField,this.swfUpdateManager=t.SwfUpdateManager.createSwfUpdateManager(a)}return e.prototype.createSprite=function(i,o,a){void 0===o&&(o=null),void 0===a&&(a=null),null==a&&(a=this._swfData[e.dataKey_Sprite][i]);for(var s,n,r,h=new t.SwfSprite,l=a.length,m=0;l>m;m++)s=a[m],r=this._createDisplayFuns[s[1]],null!=r&&(n=r.apply(this,[s[0],s]),n.name=s[9],n.x=s[2],n.y=s[3],s[0]==e.dataKey_TextField,s[1]!=e.dataKey_Scale9&&s[1]!=e.dataKey_ShapeImg&&(n.scaleX=s[4],n.scaleY=s[5]),n.skewX=s[6],n.skewY=s[7],n.alpha=s[8],h.addChild(n));return h},e.prototype.createMovie=function(i,o,a){void 0===o&&(o=null),void 0===a&&(a=null);var s,n,r,h,l,m=this._swfData[e.dataKey_MovieClip][i],p=m.objCount,d={};
for(l in p){n=p[l][0],r=p[l][1],s=null==d[l]?[]:d[l];for(var c=0;r>c;c++)h=this._createDisplayFuns[n],null!=h&&s.push(h.apply(this,[l,null]));d[l]=s}var u;return u=null==a?new t.SwfMovieClip(m.frames,m.labels,d,this):new a(m.frames,m.labels,d,this),u.loop=m.loop,u},e.prototype.createImage=function(t,i){void 0===i&&(i=null);var o=this._swfData[e.dataKey_Image][t],a=this._assetManager.createBitmap(t);return a.anchorOffsetX=o[0],a.anchorOffsetY=o[1],a},e.prototype.getTexture=function(t){return this._assetManager.getTexture(t)},e.prototype.createS9Image=function(t,i){void 0===i&&(i=null);var o=this._swfData[e.dataKey_Scale9][t],a=this._assetManager.createBitmap(t);return a.scale9Grid=new egret.Rectangle(o[0],o[1],o[2],o[3]),null!=i&&(a.width=i[10],a.height=i[11]),a},e.prototype.createShapeImage=function(t,e){void 0===e&&(e=null);var i=this._assetManager.createBitmap(t);return i.fillMode=egret.BitmapFillMode.REPEAT,null!=e&&(i.width=e[10],i.height=e[11]),i},e.prototype.createTextField=function(t,e){void 0===e&&(e=null);var i=new egret.TextField;return null!=e&&(i.width=e[10],i.height=e[11],i.textColor=e[13],i.size=e[14],i.textAlign=e[15],i.text=e[18]),i},e.prototype.hasSprite=function(t){return null!=this._swfData[e.dataKey_Sprite][t]},e.prototype.hasMovieClip=function(t){return null!=this._swfData[e.dataKey_MovieClip][t]},e.prototype.hasImage=function(t){return null!=this._swfData[e.dataKey_Image][t]},e.prototype.hasS9Image=function(t){return null!=this._swfData[e.dataKey_Scale9][t]},e.prototype.hasShapeImage=function(t){return null!=this._swfData[e.dataKey_ShapeImg][t]},e.dataKey_Sprite="spr",e.dataKey_Image="img",e.dataKey_MovieClip="mc",e.dataKey_TextField="text",e.dataKey_Button="btn",e.dataKey_Scale9="s9",e.dataKey_ShapeImg="shapeImg",e.dataKey_Component="comp",e.dataKey_Particle="particle",e}();t.Swf=e,__reflect(e.prototype,"starlingswf.Swf")}(starlingswf||(starlingswf={}));var SwfAnimationInfo=function(){function t(){}return t.arr=["l","o","c","a","t","i","o","n"],t}();__reflect(SwfAnimationInfo.prototype,"SwfAnimationInfo");var starlingswf;!function(t){var e=function(){function t(){this._sheets={},this._textures={}}return t.prototype.addSpriteSheet=function(t,e){this._sheets[t]=e},t.prototype.addTexture=function(t,e){this._textures[t]=e},t.prototype.createBitmap=function(t){var e=this.getTexture(t);if(null==e)return null;var i=new egret.Bitmap;return i.texture=e,i},t.prototype.getTexture=function(t){var e,i,o;for(o in this._sheets)if(i=this._sheets[o],e=i.getTexture(t),null!=e)break;return null==e&&(e=this._textures[t]),e},t.hrefValue="",t}();t.SwfAssetManager=e,__reflect(e.prototype,"starlingswf.SwfAssetManager")}(starlingswf||(starlingswf={}));var GameData=function(){function t(){}return t.isCreateRoomBtnClick=!1,t.isQuickJoinBtnClick=!1,t.isJoinRoomBtn1Click=!1,t.isJoinRoomBtn2Click=!1,t.isRoomItemClick=!1,t.isLeaveRoomBtnClick=!1,t.isLeaveRoomBtn2Click=!1,t.isShowProfileView=!1,t.isShowJoinRoomView=!1,t.isShowRandomMatchView=!1,t.isAddRobot=!1,t.isOwner=!1,t.ownerId=0,t.lastRoomId="",t.roomId="",t.players=[],t.gold=10,t.allValue=0,t.winValue=0,t.type="",t.curScene=1,t.gameTime=600,t.isInRoomView=!1,t.isInEnterView=!1,t.initStatus=1,t.registerStatus=1,t.loginStatus=1,t.createRoomStatus=1,t.joinRandomRoomStatus=1,t.joinRoomStatus=1,t.leaveRoomStatus=1,t.joinOverStatus=1,t.logoutStatus=1,t.getRoomListStatus=1,t.kickPlayerStatus=1,t.setFrameStatus=1,t.isGameStart=!1,t.isGameOver=!1,t.isWin=!1,t.enemyNum=0,t.closeMusic=!1,t.closeBgMusic=!1,t.isClickBtn=!1,t.bgSpeed=3,t.enemySpeed=36,t.createEnemyTime=60,t.profectNum=0,t.langNum=0,t.isServerErrorCode1000=!1,t}();__reflect(GameData.prototype,"GameData");var starlingswf;!function(t){var e=function(){function t(){}return t.createSwfUpdateManager=function(e){var i=new t;return i._animations=[],i._addQueue=[],i._removeQueue=[],i._currentTime=0,i.setFps(e),egret.Ticker.getInstance().register(i.update,i),i},t.prototype.clear=function(){this._addQueue.splice(0),this._removeQueue.splice(0),this._animations.splice(0)},t.prototype.stop=function(){this.clear(),egret.Ticker.getInstance().unregister(this.update,this)},t.prototype.play=function(){egret.Ticker.getInstance().register(this.update,this)},t.prototype.setFps=function(t){this._fps=t,this._fpsTime=1e3/t},t.prototype.addSwfAnimation=function(t){this._addQueue.push(t)},t.prototype.removeSwfAnimation=function(t){this._removeQueue.push(t);var e=this._addQueue.indexOf(t);-1!=e&&this._addQueue.splice(e,1)},t.prototype.updateAdd=function(){for(var t,e,i=this._addQueue.length,o=0;i>o;o++)e=this._addQueue.pop(),t=this._animations.indexOf(e),-1==t&&this._animations.push(e)},t.prototype.updateRemove=function(){for(var t,e,i=this._removeQueue.length,o=0;i>o;o++)e=this._removeQueue.pop(),t=this._animations.indexOf(e),-1!=t&&this._animations.splice(t,1)},t.prototype.update=function(t){if(this._currentTime+=t,!(this._currentTime<this._fpsTime)){this._currentTime-=this._fpsTime,this._update();for(var e=0;this._currentTime>this._fpsTime;)this._currentTime-=this._fpsTime,e++,4>e&&this._update()}},t.prototype._update=function(){this.updateRemove(),this.updateAdd();for(var t=this._animations.length,e=0;t>e;e++)this._animations[e].update()},t}();t.SwfUpdateManager=e,__reflect(e.prototype,"starlingswf.SwfUpdateManager")}(starlingswf||(starlingswf={}));var StarlingswfMovieClip=function(){function t(){}return t.swfFrame=egret.getDefinitionByName(SwfFrameInfo.swfNum),t}();__reflect(StarlingswfMovieClip.prototype,"StarlingswfMovieClip");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.logoUrl="resource/assets/loading_logo.png",e.bgUrl="resource/assets/loading_bg.jpg",e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.w=Const.SCENT_WIDTH,this.h=Const.SCENT_HEIGHT,this.textField=new egret.TextField,this.textField.y=500,this.textField.textColor=3355443,this.textField.size=23,this.textField.width=this.w,this.textField.height=100,this.textField.fontFamily="Black",this.textField.textAlign="center",this.textField_power=new egret.TextField,this.textField_power.y=.9*this.h,this.textField_power.textColor=3355443,this.textField_power.width=this.w,this.textField_power.height=100,this.textField_power.size=20,this.textField_power.text="Powered by Egret Engine",this.textField_power.fontFamily="Black",this.textField_power.textAlign="center";var t=new egret.URLLoader;t.addEventListener(egret.Event.COMPLETE,this.onComplete,this),t.dataFormat=egret.URLLoaderDataFormat.TEXTURE,t.load(new egret.URLRequest(this.logoUrl));var t=new egret.URLLoader;t.addEventListener(egret.Event.COMPLETE,this.onComplete,this),t.dataFormat=egret.URLLoaderDataFormat.TEXTURE,t.load(new egret.URLRequest(this.bgUrl)),this.bg=new egret.Bitmap,this.logo=new egret.Bitmap,this.uiContainer=new egret.DisplayObjectContainer,this.addChild(this.uiContainer),this.addChild(this.logo),this.addChildAt(this.bg,0),this.addChild(this.textField),this.addChild(this.textField_power)},e.prototype.onComplete=function(t){var e=t.target,i=e.data;e._request.url==this.bgUrl?(this.bg.texture=i,this.bg.scaleX=this.w/640,this.bg.scaleY=this.h/960):e._request.url==this.logoUrl&&(this.logo.texture=i,this.logo.anchorOffsetX=.5*this.logo.width,this.logo.anchorOffsetY=.5*this.logo.height,this.logo.x=this.w/2,this.logo.y=this.h/2-60,this.logo.scaleX=this.logo.scaleY=this.h/960,this.textField.y=this.logo.y+100)},e.prototype.setProgress=function(t,e){var i=Math.floor(t/e*100);this.textField.text="游戏加载中…"+i+"%"},e.prototype.onLoadComplete=function(t,e){t.call(e)},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(t){function e(){var e=t.call(this)||this;return e._loadTimes=0,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),RES.registerAnalyzer("starlingswf_sheet",starlingswf.StarlingSwfSheetAnalyzer),MvsManager.response.initResponse=e.mvsInitResponse.bind(e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){Const.SCENT_WIDTH=this.stage.stageWidth,Const.SCENT_HEIGHT=this.stage.stageHeight,this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/"),LocalStore_Clear(),this.init()},e.prototype.init=function(){if(6!==GameData.initStatus){if(2===GameData.initStatus||5===GameData.initStatus)return console.warn("sdk initing or waiting response"),void console.warn("GameData.initStatus:",GameData.initStatus);GameData.initStatus=2,this.mvsInit()}},e.prototype.mvsInit=function(){var t=MvsManager.getInstance().init();return 0!==t?(GameData.initStatus=4,void console.error("sdk init error",t)):(GameData.initStatus=3,console.log("sdk init ok",t),void(GameData.initStatus=5))},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.createGroup("initLoad",["preload","bgPic","animation","sound"]),RES.loadGroup("initLoad")},e.prototype.onResourceLoadComplete=function(t){"initLoad"==t.groupName&&this.loadingView.onLoadComplete(this.onStartGame,this)},e.prototype.onResourceProgress=function(t){"initLoad"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},e.prototype.onResourceLoadError=function(t){this._loadTimes++,this._loadTimes>3?AlertPanel.i().showErr("网络异常，请重新进入游戏"):RES.loadGroup(t.groupName)},e.prototype.mvsInitResponse=function(t){200===t?(GameData.initStatus=6,console.log("response init ok",t)):(GameData.initStatus=7,console.error("response init error",t))},e.prototype.onStartGame=function(){this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),this.initAnimationData(),this.createGameScene()},e.prototype.initAnimationData=function(){for(var t=["redNu","promptPop","honglang","lanlang","go","xiaohongmao","xiaolanmao"],e=0,i=t.length;i>e;e++){var o=t[e];StarlingSwfFactory.getInstance().addSwf(o,RES.getRes(o+"_swf"),RES.getRes(o))}},e.prototype.createGameScene=function(){Const.GamePoxY=0,GameData.curScene=1;var t=new egret.Rectangle;t.width=Const.SCENT_WIDTH,t.height=Const.SCENT_HEIGHT,t.y=Const.GamePoxY,SoundUtils.instance().initSound(),this._scene=new GameSceneView,this._scene.y=Const.GamePoxY,this._scene.width=Const.SCENT_WIDTH,this._scene.height=Const.SCENT_HEIGHT,this._scene.mask=t,this.addChild(this._scene)},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var StarlingSwfFactory=function(){function t(){this.swfAssetsManager=new starlingswf.SwfAssetManager,this.swfAssetsNames=new Array,this.swfAssets=new Array,this.swfData={}}return t.getInstance=function(){return null==t._instance&&(t._instance=new t),t._instance},t.prototype.addSwf=function(t,e,i){if(-1==this.swfAssetsNames.indexOf(t)){if(null==e||null==i)return void console.log("SWF加载失败:"+t);this.swfAssetsManager.addSpriteSheet(t,i);var o=new starlingswf.Swf(e,this.swfAssetsManager,24);o.name=t,StarlingSwfUtils.addSwf(o),this.swfAssetsNames.push(t),this.swfAssets.push(o)}},t.prototype.stopSwfs=function(t){for(var e=0,i=t.length;i>e;e++){var o=StarlingSwfUtils.getSwf(t[e]);o&&o.swfUpdateManager.stop()}},t.prototype.playSwfs=function(t){for(var e=0,i=t.length;i>e;e++){var o=StarlingSwfUtils.getSwf(t[e]);o&&o.swfUpdateManager.play()}},t.prototype.clearSwfs=function(){for(;this.swfAssets.length;)StarlingSwfUtils.removeSwf(this.swfAssets.pop());for(;this.swfAssetsNames.length;)this.swfAssetsNames.pop();this.swfAssetsManager=new starlingswf.SwfAssetManager},t.prototype.clear=function(){this.clearSwfs()},t.prototype.makeMc=function(t){var e=StarlingSwfUtils.createMovie("mc_"+t,null,StarlingSwfMovieClip);return null==e&&console.log("SWF创建失败: "+t),e},t.prototype.makeImage=function(t){return StarlingSwfUtils.createImage("img_"+t)},t.prototype.getTexture=function(t){return StarlingSwfUtils.getTexture("img_"+t)},t}();__reflect(StarlingSwfFactory.prototype,"StarlingSwfFactory");var StarlingSwfMovieClip=function(t){function e(e,i,o,a){var s=t.call(this,e,i,o,a)||this;return s.frameActions={},s.preFrame=-1,s.addEventListener(egret.Event.REMOVED_FROM_STAGE,s.onRemove,s),s}return __extends(e,t),e.prototype.onRemove=function(){this.stop()},e.prototype.setFrameAction=function(t,e,i,o){void 0===o&&(o=null),this.frameActions[t]=[e,i,o]},e.prototype.setCompleteAction=function(t,e){this.complateFunc=t,this.complateObj=e,this.addEventListener(egret.Event.COMPLETE,this.onPlayend,this)},e.prototype.onPlayend=function(){this.complateFunc&&this.complateFunc.call(this.complateObj)},e.prototype.goToPlay=function(t){this.preFrame=-1,this.currFrameName=t,this.gotoAndPlay(t)},e.prototype.update=function(){t.prototype.update.call(this);var e=this.getCurrentFrame();if(this.preFrame!=e&&(this.preFrame=e,this.frameActions&&this.frameActions[e])){var i=this.frameActions[e];i[2]?i[0].call(i[1],i[2]):i[0].call(i[1])}},e.prototype.dispose=function(){this.stop(),this.removeEventListener(egret.Event.COMPLETE,this.onPlayend,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),this.parent&&this.parent.removeChild(this),this.complateFunc=null,this.complateObj=null,this.frameActions=null},e}(starlingswf.SwfMovieClip);__reflect(StarlingSwfMovieClip.prototype,"StarlingSwfMovieClip");var StarlingSwfUtils=function(){function t(){}return t.addSwf=function(e){t.swfList.push(e)},t.removeSwf=function(e){var i=t.swfList.indexOf(e);-1!=i&&t.swfList.splice(i,1)},t.createSprite=function(e,i,o){void 0===i&&(i=null),void 0===o&&(o=null);for(var a=t.swfList.length,s=0;a>s;s++){var n=t.swfList[s];if(n.hasSprite(e))return n.createSprite(e,i,o)}return null},t.createImage=function(e,i){void 0===i&&(i=null);for(var o=t.swfList.length,a=0;o>a;a++){var s=t.swfList[a];if(s.hasImage(e))return s.createImage(e,i)}return null},t.getTexture=function(e){for(var i=t.swfList.length,o=0;i>o;o++){var a=t.swfList[o];if(a.hasImage(e))return a.getTexture(e)}return null},t.createMovie=function(e,i,o){void 0===i&&(i=null),void 0===o&&(o=null);for(var a=t.swfList.length,s=0;a>s;s++){var n=t.swfList[s];if(n.hasMovieClip(e))return n.createMovie(e,i,o)}return null},t.createS9Image=function(e,i){void 0===i&&(i=null);for(var o=t.swfList.length,a=0;o>a;a++){var s=t.swfList[a];if(s.hasS9Image(e))return s.createS9Image(e,i)}return null},t.createShapeImage=function(e,i){void 0===i&&(i=null);for(var o=t.swfList.length,a=0;o>a;a++){var s=t.swfList[a];if(s.hasShapeImage(e))return s.createShapeImage(e,i)}return null},t.getSwf=function(e){for(var i=t.swfList.length,o=0;i>o;o++){var a=t.swfList[o];if(a.name==e)return a}return null},t.fixButton=function(e,i,o){t.firstAddBtn&&(t.firstAddBtn=!1,egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),egret.MainContext.instance.stage.addEventListener(egret.Event.LEAVE_STAGE,this.onTouchEnd,this));var a=new StarlingSwfButtonData;a.btn=e,a.onClick=i,a.thisObj=o,t.btnList.push(a),e.touchEnabled=!0,e.gotoAndStop(0),e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBtnTouchBegin,e)},t.onBtnTouchBegin=function(e){for(var i=e.currentTarget,o=t.btnList.length,a=0;o>a;a++){var s=t.btnList[a];if(s.btn==i){s.touchStageX=e.stageX,s.touchStageY=e.stageY,i.gotoAndStop(1);break}}},t.onTouchEnd=function(e){for(var i=t.btnList.length,o=0;i>o;o++){var a=t.btnList[o];-1!=a.touchStageX&&(e.stageX&&Math.abs(a.touchStageX-e.stageX)<10&&Math.abs(a.touchStageY-e.stageY)<10&&a.onClick&&a.onClick.call(a.thisObj,e),a.touchStageX=-1,a.touchStageY=-1,a.btn.gotoAndStop(0))}},t.swfList=[],t.btnList=[],t.firstAddBtn=!0,t}();__reflect(StarlingSwfUtils.prototype,"StarlingSwfUtils");var StarlingSwfButtonData=function(){function t(){this.touchStageX=-1,this.touchStageY=-1}return t}();__reflect(StarlingSwfButtonData.prototype,"StarlingSwfButtonData"),window.Main=Main;